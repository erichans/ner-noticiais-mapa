C:\Users\aceite\anaconda3\envs\ner-noticias-mapa\python.exe C:/projetos/ner-noticiais-mapa/main.py
INFO:filelock:Lock 2262205872880 acquired on C:\Users\aceite/.cache\huggingface\transformers\9cfcd25de0a333b1b5f4a3db227e93a806cfb041d93a49221eeaee6773eaa41c.af25fb1e29ad0175300146695fd80069be69b211c52fa5486fa8aae2754cc814.lock
https://huggingface.co/neuralmind/bert-large-portuguese-cased/resolve/main/vocab.txt not found in cache or force_download set to True, downloading to C:\Users\aceite\.cache\huggingface\transformers\tmp37z3gthq
Downloading: 100%|██████████| 210k/210k [00:00<00:00, 482kB/s] 
storing https://huggingface.co/neuralmind/bert-large-portuguese-cased/resolve/main/vocab.txt in cache at C:\Users\aceite/.cache\huggingface\transformers\9cfcd25de0a333b1b5f4a3db227e93a806cfb041d93a49221eeaee6773eaa41c.af25fb1e29ad0175300146695fd80069be69b211c52fa5486fa8aae2754cc814
creating metadata file for C:\Users\aceite/.cache\huggingface\transformers\9cfcd25de0a333b1b5f4a3db227e93a806cfb041d93a49221eeaee6773eaa41c.af25fb1e29ad0175300146695fd80069be69b211c52fa5486fa8aae2754cc814
INFO:filelock:Lock 2262205872880 released on C:\Users\aceite/.cache\huggingface\transformers\9cfcd25de0a333b1b5f4a3db227e93a806cfb041d93a49221eeaee6773eaa41c.af25fb1e29ad0175300146695fd80069be69b211c52fa5486fa8aae2754cc814.lock
INFO:filelock:Lock 2262205935136 acquired on C:\Users\aceite/.cache\huggingface\transformers\6a3aa038873b8f0d0ab3a4de0a658f063b89e3afd815920a5f393c0e4ae84259.5cc6e825eb228a7a5cfd27cb4d7151e97a79fb962b31aaf1813aa102e746584b.lock
https://huggingface.co/neuralmind/bert-large-portuguese-cased/resolve/main/added_tokens.json not found in cache or force_download set to True, downloading to C:\Users\aceite\.cache\huggingface\transformers\tmpy4_q4y_o
Downloading: 100%|██████████| 2.00/2.00 [00:00<?, ?B/s]
storing https://huggingface.co/neuralmind/bert-large-portuguese-cased/resolve/main/added_tokens.json in cache at C:\Users\aceite/.cache\huggingface\transformers\6a3aa038873b8f0d0ab3a4de0a658f063b89e3afd815920a5f393c0e4ae84259.5cc6e825eb228a7a5cfd27cb4d7151e97a79fb962b31aaf1813aa102e746584b
creating metadata file for C:\Users\aceite/.cache\huggingface\transformers\6a3aa038873b8f0d0ab3a4de0a658f063b89e3afd815920a5f393c0e4ae84259.5cc6e825eb228a7a5cfd27cb4d7151e97a79fb962b31aaf1813aa102e746584b
INFO:filelock:Lock 2262205935136 released on C:\Users\aceite/.cache\huggingface\transformers\6a3aa038873b8f0d0ab3a4de0a658f063b89e3afd815920a5f393c0e4ae84259.5cc6e825eb228a7a5cfd27cb4d7151e97a79fb962b31aaf1813aa102e746584b.lock
INFO:filelock:Lock 2262205872928 acquired on C:\Users\aceite/.cache\huggingface\transformers\d5b721c156180bbbcc4a1017e8c72a18f8f96cdc178acec5ddcd45905712b4cf.dd8bd9bfd3664b530ea4e645105f557769387b3da9f79bdb55ed556bdd80611d.lock
https://huggingface.co/neuralmind/bert-large-portuguese-cased/resolve/main/special_tokens_map.json not found in cache or force_download set to True, downloading to C:\Users\aceite\.cache\huggingface\transformers\tmpr68zcpyb
Downloading: 100%|██████████| 112/112 [00:00<?, ?B/s] 
storing https://huggingface.co/neuralmind/bert-large-portuguese-cased/resolve/main/special_tokens_map.json in cache at C:\Users\aceite/.cache\huggingface\transformers\d5b721c156180bbbcc4a1017e8c72a18f8f96cdc178acec5ddcd45905712b4cf.dd8bd9bfd3664b530ea4e645105f557769387b3da9f79bdb55ed556bdd80611d
creating metadata file for C:\Users\aceite/.cache\huggingface\transformers\d5b721c156180bbbcc4a1017e8c72a18f8f96cdc178acec5ddcd45905712b4cf.dd8bd9bfd3664b530ea4e645105f557769387b3da9f79bdb55ed556bdd80611d
INFO:filelock:Lock 2262205872928 released on C:\Users\aceite/.cache\huggingface\transformers\d5b721c156180bbbcc4a1017e8c72a18f8f96cdc178acec5ddcd45905712b4cf.dd8bd9bfd3664b530ea4e645105f557769387b3da9f79bdb55ed556bdd80611d.lock
INFO:filelock:Lock 2262205934512 acquired on C:\Users\aceite/.cache\huggingface\transformers\3a44fa9a74e90f509368a7f2789df38e1fedd153a52c62ef5cc5f4b0f5c99c2a.d61b68f744aef2741575c270d4ba0228cd35693bfa15d8babfb5c1079062d5d7.lock
https://huggingface.co/neuralmind/bert-large-portuguese-cased/resolve/main/tokenizer_config.json not found in cache or force_download set to True, downloading to C:\Users\aceite\.cache\huggingface\transformers\tmpwc353j12
Downloading: 100%|██████████| 155/155 [00:00<00:00, 51.0kB/s]
storing https://huggingface.co/neuralmind/bert-large-portuguese-cased/resolve/main/tokenizer_config.json in cache at C:\Users\aceite/.cache\huggingface\transformers\3a44fa9a74e90f509368a7f2789df38e1fedd153a52c62ef5cc5f4b0f5c99c2a.d61b68f744aef2741575c270d4ba0228cd35693bfa15d8babfb5c1079062d5d7
creating metadata file for C:\Users\aceite/.cache\huggingface\transformers\3a44fa9a74e90f509368a7f2789df38e1fedd153a52c62ef5cc5f4b0f5c99c2a.d61b68f744aef2741575c270d4ba0228cd35693bfa15d8babfb5c1079062d5d7
INFO:filelock:Lock 2262205934512 released on C:\Users\aceite/.cache\huggingface\transformers\3a44fa9a74e90f509368a7f2789df38e1fedd153a52c62ef5cc5f4b0f5c99c2a.d61b68f744aef2741575c270d4ba0228cd35693bfa15d8babfb5c1079062d5d7.lock
loading file https://huggingface.co/neuralmind/bert-large-portuguese-cased/resolve/main/vocab.txt from cache at C:\Users\aceite/.cache\huggingface\transformers\9cfcd25de0a333b1b5f4a3db227e93a806cfb041d93a49221eeaee6773eaa41c.af25fb1e29ad0175300146695fd80069be69b211c52fa5486fa8aae2754cc814
loading file https://huggingface.co/neuralmind/bert-large-portuguese-cased/resolve/main/tokenizer.json from cache at None
loading file https://huggingface.co/neuralmind/bert-large-portuguese-cased/resolve/main/added_tokens.json from cache at C:\Users\aceite/.cache\huggingface\transformers\6a3aa038873b8f0d0ab3a4de0a658f063b89e3afd815920a5f393c0e4ae84259.5cc6e825eb228a7a5cfd27cb4d7151e97a79fb962b31aaf1813aa102e746584b
loading file https://huggingface.co/neuralmind/bert-large-portuguese-cased/resolve/main/special_tokens_map.json from cache at C:\Users\aceite/.cache\huggingface\transformers\d5b721c156180bbbcc4a1017e8c72a18f8f96cdc178acec5ddcd45905712b4cf.dd8bd9bfd3664b530ea4e645105f557769387b3da9f79bdb55ed556bdd80611d
loading file https://huggingface.co/neuralmind/bert-large-portuguese-cased/resolve/main/tokenizer_config.json from cache at C:\Users\aceite/.cache\huggingface\transformers\3a44fa9a74e90f509368a7f2789df38e1fedd153a52c62ef5cc5f4b0f5c99c2a.d61b68f744aef2741575c270d4ba0228cd35693bfa15d8babfb5c1079062d5d7
loading configuration file https://huggingface.co/neuralmind/bert-large-portuguese-cased/resolve/main/config.json from cache at C:\Users\aceite/.cache\huggingface\transformers\c534071830642050813fa94003dbf1234413b3f1d5dc66d259fbc82ff7d5fd59.c8340a82acfbbcd2dd960b86d2886ee120b21896ef0294150f0391918ae6ced5
Model config BertConfig {
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "directionality": "bidi",
  "gradient_checkpointing": false,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 1024,
  "id2label": {
    "0": "B-LOC",
    "1": "B-ORG",
    "2": "B-PESSOA",
    "3": "I-LOC",
    "4": "I-ORG",
    "5": "I-PESSOA",
    "6": "O"
  },
  "initializer_range": 0.02,
  "intermediate_size": 4096,
  "label2id": {
    "B-LOC": 0,
    "B-ORG": 1,
    "B-PESSOA": 2,
    "I-LOC": 3,
    "I-ORG": 4,
    "I-PESSOA": 5,
    "O": 6
  },
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 16,
  "num_hidden_layers": 24,
  "output_past": true,
  "pad_token_id": 0,
  "pooler_fc_size": 768,
  "pooler_num_attention_heads": 12,
  "pooler_num_fc_layers": 3,
  "pooler_size_per_head": 128,
  "pooler_type": "first_token_transform",
  "position_embedding_type": "absolute",
  "transformers_version": "4.5.1",
  "type_vocab_size": 2,
  "use_cache": true,
  "vocab_size": 29794
}

loading weights file https://huggingface.co/neuralmind/bert-large-portuguese-cased/resolve/main/pytorch_model.bin from cache at C:\Users\aceite/.cache\huggingface\transformers\016fb7702039667c9fb9dd2ceffaf04027b13e525a6248cda2a4a87dbb8687af.881d7200bce807f871637ac9d552c541b2d4b00146a0bf1ab0360f3640031273
Some weights of the model checkpoint at neuralmind/bert-large-portuguese-cased were not used when initializing BertNER: ['cls.predictions.bias', 'cls.predictions.transform.dense.weight', 'cls.predictions.transform.dense.bias', 'cls.predictions.transform.LayerNorm.weight', 'cls.predictions.transform.LayerNorm.bias', 'cls.predictions.decoder.weight', 'cls.seq_relationship.weight', 'cls.seq_relationship.bias', 'bert.pooler.dense.weight', 'bert.pooler.dense.bias']
- This IS expected if you are initializing BertNER from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertNER from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of BertNER were not initialized from the model checkpoint at neuralmind/bert-large-portuguese-cased and are newly initialized: ['classifier.weight', 'classifier.bias', 'loss_function.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
PyTorch: setting up devices
The default value for the training argument `--report_to` will change in v5 (from all installed integrations to none). In v5, you will need to use `--report_to all` to get the same behavior as now. You should start updating your code and make this info disappear :-).
***** Running training *****
  Num examples = 400
  Num Epochs = 30
  Instantaneous batch size per device = 3
  Total train batch size (w. parallel, distributed & accumulation) = 3
  Gradient Accumulation steps = 1
  Total optimization steps = 4020
  0%|          | 10/4020 [00:05<32:16,  2.07it/s]{'loss': 1.973, 'learning_rate': 1.0000000000000002e-06, 'epoch': 0.07}
  0%|          | 20/4020 [00:10<30:16,  2.20it/s]{'loss': 1.8, 'learning_rate': 2.0000000000000003e-06, 'epoch': 0.15}
  1%|          | 30/4020 [00:14<29:52,  2.23it/s]{'loss': 1.4455, 'learning_rate': 3e-06, 'epoch': 0.22}
  1%|          | 40/4020 [00:19<30:05,  2.20it/s]{'loss': 0.9223, 'learning_rate': 4.000000000000001e-06, 'epoch': 0.3}
  1%|          | 50/4020 [00:23<30:50,  2.15it/s]{'loss': 0.4757, 'learning_rate': 5e-06, 'epoch': 0.37}
  1%|▏         | 60/4020 [00:28<30:41,  2.15it/s]{'loss': 0.4046, 'learning_rate': 6e-06, 'epoch': 0.45}
  2%|▏         | 70/4020 [00:33<30:07,  2.19it/s]{'loss': 0.4062, 'learning_rate': 7.000000000000001e-06, 'epoch': 0.52}
  2%|▏         | 80/4020 [00:37<29:45,  2.21it/s]{'loss': 0.3192, 'learning_rate': 8.000000000000001e-06, 'epoch': 0.6}
  2%|▏         | 90/4020 [00:42<29:42,  2.20it/s]{'loss': 0.2147, 'learning_rate': 9e-06, 'epoch': 0.67}
  2%|▏         | 100/4020 [00:46<29:36,  2.21it/s]{'loss': 0.2004, 'learning_rate': 1e-05, 'epoch': 0.75}
  3%|▎         | 110/4020 [00:51<29:50,  2.18it/s]{'loss': 0.2062, 'learning_rate': 1.1000000000000001e-05, 'epoch': 0.82}
  3%|▎         | 120/4020 [00:55<29:30,  2.20it/s]{'loss': 0.1732, 'learning_rate': 1.2e-05, 'epoch': 0.9}
  3%|▎         | 130/4020 [01:00<29:54,  2.17it/s]{'loss': 0.1762, 'learning_rate': 1.3000000000000001e-05, 'epoch': 0.97}
  3%|▎         | 134/4020 [01:02<27:32,  2.35it/s]***** Running Evaluation *****
  Num examples = 100
  Batch size = 3

  0%|          | 0/34 [00:00<?, ?it/s]
  9%|▉         | 3/34 [00:00<00:01, 16.74it/s]
 15%|█▍        | 5/34 [00:00<00:02, 14.00it/s]
 21%|██        | 7/34 [00:00<00:02, 12.40it/s]
 26%|██▋       | 9/34 [00:00<00:02, 11.85it/s]
 32%|███▏      | 11/34 [00:00<00:01, 11.61it/s]
 38%|███▊      | 13/34 [00:01<00:01, 11.67it/s]
 44%|████▍     | 15/34 [00:01<00:01, 11.33it/s]
 50%|█████     | 17/34 [00:01<00:01, 11.40it/s]
 56%|█████▌    | 19/34 [00:01<00:01, 11.22it/s]
 62%|██████▏   | 21/34 [00:01<00:01, 11.24it/s]
 68%|██████▊   | 23/34 [00:01<00:00, 11.23it/s]
 74%|███████▎  | 25/34 [00:02<00:00, 11.52it/s]
 79%|███████▉  | 27/34 [00:02<00:00, 11.12it/s]
 85%|████████▌ | 29/34 [00:02<00:00, 11.15it/s]
 91%|█████████ | 31/34 [00:02<00:00, 11.25it/s]
 97%|█████████▋| 33/34 [00:02<00:00, 10.82it/s]{'TP': 2971, 'FP': 669, 'FN': 120, 'TN': 26533}
C:\Users\aceite\anaconda3\envs\ner-noticias-mapa\lib\site-packages\sklearn\utils\validation.py:70: FutureWarning: Pass labels=['B-LOC', 'B-ORG', 'B-PESSOA', 'I-LOC', 'I-ORG', 'I-PESSOA', 'O'] as keyword args. From version 1.0 (renaming of 0.25) passing these as positional arguments will result in an error
  warnings.warn(f"Pass {args_msg} as keyword args. From version "
              precision    recall  f1-score   support

         LOC       0.73      0.80      0.76       279
         ORG       0.70      0.85      0.77       786
      PESSOA       0.76      0.92      0.83       323

   micro avg       0.72      0.86      0.78      1388
   macro avg       0.73      0.86      0.79      1388
weighted avg       0.72      0.86      0.78      1388

              precision    recall  f1-score   support

       B-LOC       0.78      0.82      0.80       277
       B-ORG       0.84      0.91      0.87       782
    B-PESSOA       0.80      0.94      0.87       322
       I-LOC       0.79      0.84      0.81       154
       I-ORG       0.81      0.90      0.85      1312
    I-PESSOA       0.84      0.96      0.90       434
           O       1.00      0.98      0.99     27012

    accuracy                           0.97     30293
   macro avg       0.84      0.91      0.87     30293
weighted avg       0.98      0.97      0.97     30293

f1 0.7818361303060216 f1_masked 0.8102633355840648
{'eval_loss': 0.10354664921760559, 'eval_accuracy_score': 0.9739543788994157, 'eval_precision': 0.7195639006662629, 'eval_recall': 0.8559077809798271, 'eval_f1': 0.7818361303060216, 'eval_f1_masked': 0.8102633355840648, 'eval_runtime': 4.8801, 'eval_samples_per_second': 20.491, 'epoch': 1.0}
                                                  
  3%|▎         | 134/4020 [01:07<27:32,  2.35it/s]
100%|██████████| 34/34 [00:04<00:00, 10.82it/s]
                                               Saving model checkpoint to ./results\checkpoint-134
Configuration saved in ./results\checkpoint-134\config.json
Model weights saved in ./results\checkpoint-134\pytorch_model.bin
  3%|▎         | 140/4020 [01:13<58:04,  1.11it/s]{'loss': 0.0893, 'learning_rate': 1.4000000000000001e-05, 'epoch': 1.04}
  4%|▎         | 150/4020 [01:18<30:43,  2.10it/s]{'loss': 0.0584, 'learning_rate': 1.5e-05, 'epoch': 1.12}
  4%|▍         | 160/4020 [01:23<30:17,  2.12it/s]{'loss': 0.1177, 'learning_rate': 1.6000000000000003e-05, 'epoch': 1.19}
  4%|▍         | 170/4020 [01:27<29:24,  2.18it/s]{'loss': 0.0567, 'learning_rate': 1.7000000000000003e-05, 'epoch': 1.27}
  4%|▍         | 180/4020 [01:32<29:10,  2.19it/s]{'loss': 0.0613, 'learning_rate': 1.8e-05, 'epoch': 1.34}
  5%|▍         | 190/4020 [01:36<28:53,  2.21it/s]{'loss': 0.0535, 'learning_rate': 1.9e-05, 'epoch': 1.42}
  5%|▍         | 200/4020 [01:41<29:16,  2.17it/s]{'loss': 0.0885, 'learning_rate': 2e-05, 'epoch': 1.49}
  5%|▌         | 210/4020 [01:46<29:40,  2.14it/s]{'loss': 0.0895, 'learning_rate': 2.1e-05, 'epoch': 1.57}
  5%|▌         | 220/4020 [01:50<29:07,  2.17it/s]{'loss': 0.0595, 'learning_rate': 2.2000000000000003e-05, 'epoch': 1.64}
  6%|▌         | 230/4020 [01:55<29:32,  2.14it/s]{'loss': 0.127, 'learning_rate': 2.3000000000000003e-05, 'epoch': 1.72}
  6%|▌         | 240/4020 [01:59<29:03,  2.17it/s]{'loss': 0.0587, 'learning_rate': 2.4e-05, 'epoch': 1.79}
  6%|▌         | 250/4020 [02:04<28:10,  2.23it/s]{'loss': 0.0486, 'learning_rate': 2.5e-05, 'epoch': 1.87}
  6%|▋         | 260/4020 [02:08<27:49,  2.25it/s]{'loss': 0.0685, 'learning_rate': 2.6000000000000002e-05, 'epoch': 1.94}
  7%|▋         | 268/4020 [02:12<26:06,  2.40it/s]***** Running Evaluation *****
  Num examples = 100
  Batch size = 3

  0%|          | 0/34 [00:00<?, ?it/s]
  9%|▉         | 3/34 [00:00<00:01, 16.01it/s]
 15%|█▍        | 5/34 [00:00<00:02, 12.85it/s]
 21%|██        | 7/34 [00:00<00:02, 11.86it/s]
 26%|██▋       | 9/34 [00:00<00:02, 11.78it/s]
 32%|███▏      | 11/34 [00:00<00:02, 11.36it/s]
 38%|███▊      | 13/34 [00:01<00:01, 11.13it/s]
 44%|████▍     | 15/34 [00:01<00:01, 10.98it/s]
 50%|█████     | 17/34 [00:01<00:01, 11.17it/s]
 56%|█████▌    | 19/34 [00:01<00:01, 11.01it/s]
 62%|██████▏   | 21/34 [00:01<00:01, 10.91it/s]
 68%|██████▊   | 23/34 [00:02<00:01, 10.82it/s]
 74%|███████▎  | 25/34 [00:02<00:00, 10.76it/s]
 79%|███████▉  | 27/34 [00:02<00:00, 10.75it/s]
 85%|████████▌ | 29/34 [00:02<00:00, 11.01it/s]
 91%|█████████ | 31/34 [00:02<00:00, 10.90it/s]
 97%|█████████▋| 33/34 [00:02<00:00, 10.82it/s]{'TP': 3027, 'FP': 414, 'FN': 158, 'TN': 26694}
              precision    recall  f1-score   support

         LOC       0.76      0.93      0.84       279
         ORG       0.81      0.86      0.83       786
      PESSOA       0.83      0.96      0.89       323

   micro avg       0.80      0.90      0.85      1388
   macro avg       0.80      0.92      0.85      1388
weighted avg       0.80      0.90      0.85      1388

C:\Users\aceite\anaconda3\envs\ner-noticias-mapa\lib\site-packages\sklearn\utils\validation.py:70: FutureWarning: Pass labels=['B-LOC', 'B-ORG', 'B-PESSOA', 'I-LOC', 'I-ORG', 'I-PESSOA', 'O'] as keyword args. From version 1.0 (renaming of 0.25) passing these as positional arguments will result in an error
  warnings.warn(f"Pass {args_msg} as keyword args. From version "
              precision    recall  f1-score   support

       B-LOC       0.78      0.94      0.85       277
       B-ORG       0.89      0.92      0.90       782
    B-PESSOA       0.85      0.98      0.91       322
       I-LOC       0.77      0.96      0.86       154
       I-ORG       0.91      0.88      0.90      1312
    I-PESSOA       0.91      0.98      0.94       434
           O       0.99      0.99      0.99     27012

    accuracy                           0.98     30293
   macro avg       0.87      0.95      0.91     30293
weighted avg       0.98      0.98      0.98     30293

f1 0.8467302452316077 f1_masked 0.8600964851826327
                                                  
  7%|▋         | 268/4020 [02:17<26:06,  2.40it/s]
100%|██████████| 34/34 [00:04<00:00, 10.82it/s]
                                               Saving model checkpoint to ./results\checkpoint-268
Configuration saved in ./results\checkpoint-268\config.json
{'eval_loss': 0.06625615805387497, 'eval_accuracy_score': 0.9811177499752418, 'eval_precision': 0.8029715762273901, 'eval_recall': 0.8955331412103746, 'eval_f1': 0.8467302452316077, 'eval_f1_masked': 0.8600964851826327, 'eval_runtime': 4.9532, 'eval_samples_per_second': 20.189, 'epoch': 2.0}
Model weights saved in ./results\checkpoint-268\pytorch_model.bin
  7%|▋         | 270/4020 [02:22<2:25:15,  2.32s/it]{'loss': 0.0395, 'learning_rate': 2.7000000000000002e-05, 'epoch': 2.01}
  7%|▋         | 280/4020 [02:26<31:08,  2.00it/s]{'loss': 0.0299, 'learning_rate': 2.8000000000000003e-05, 'epoch': 2.09}
  7%|▋         | 290/4020 [02:31<28:52,  2.15it/s]{'loss': 0.0295, 'learning_rate': 2.9e-05, 'epoch': 2.16}
  7%|▋         | 300/4020 [02:35<28:28,  2.18it/s]{'loss': 0.0303, 'learning_rate': 3e-05, 'epoch': 2.24}
  8%|▊         | 310/4020 [02:40<28:11,  2.19it/s]{'loss': 0.0412, 'learning_rate': 3.1e-05, 'epoch': 2.31}
  8%|▊         | 320/4020 [02:44<27:50,  2.22it/s]{'loss': 0.0645, 'learning_rate': 3.2000000000000005e-05, 'epoch': 2.39}
  8%|▊         | 330/4020 [02:49<28:49,  2.13it/s]{'loss': 0.1374, 'learning_rate': 3.3e-05, 'epoch': 2.46}
  8%|▊         | 340/4020 [02:54<27:32,  2.23it/s]{'loss': 0.0453, 'learning_rate': 3.4000000000000007e-05, 'epoch': 2.54}
  9%|▊         | 350/4020 [02:58<27:57,  2.19it/s]{'loss': 0.1503, 'learning_rate': 3.5e-05, 'epoch': 2.61}
  9%|▉         | 360/4020 [03:03<27:54,  2.19it/s]{'loss': 0.0245, 'learning_rate': 3.6e-05, 'epoch': 2.69}
  9%|▉         | 370/4020 [03:07<27:22,  2.22it/s]{'loss': 0.0571, 'learning_rate': 3.7e-05, 'epoch': 2.76}
  9%|▉         | 380/4020 [03:12<27:34,  2.20it/s]{'loss': 0.0692, 'learning_rate': 3.8e-05, 'epoch': 2.84}
 10%|▉         | 390/4020 [03:16<27:38,  2.19it/s]{'loss': 0.0354, 'learning_rate': 3.9000000000000006e-05, 'epoch': 2.91}
 10%|▉         | 400/4020 [03:21<27:21,  2.20it/s]{'loss': 0.0342, 'learning_rate': 4e-05, 'epoch': 2.99}
 10%|█         | 402/4020 [03:22<25:06,  2.40it/s]***** Running Evaluation *****
  Num examples = 100
  Batch size = 3

  0%|          | 0/34 [00:00<?, ?it/s]
  9%|▉         | 3/34 [00:00<00:01, 16.00it/s]
 15%|█▍        | 5/34 [00:00<00:02, 12.52it/s]
 21%|██        | 7/34 [00:00<00:02, 11.49it/s]
 26%|██▋       | 9/34 [00:00<00:02, 11.17it/s]
 32%|███▏      | 11/34 [00:00<00:02, 10.58it/s]
 38%|███▊      | 13/34 [00:01<00:02, 10.49it/s]
 44%|████▍     | 15/34 [00:01<00:01, 10.52it/s]
 50%|█████     | 17/34 [00:01<00:01, 10.74it/s]
 56%|█████▌    | 19/34 [00:01<00:01, 10.52it/s]
 62%|██████▏   | 21/34 [00:01<00:01, 10.62it/s]
 68%|██████▊   | 23/34 [00:02<00:01, 10.53it/s]
 74%|███████▎  | 25/34 [00:02<00:00, 10.59it/s]
 79%|███████▉  | 27/34 [00:02<00:00, 10.89it/s]
 85%|████████▌ | 29/34 [00:02<00:00, 10.68it/s]
 91%|█████████ | 31/34 [00:02<00:00, 10.57it/s]
 97%|█████████▋| 33/34 [00:03<00:00, 10.44it/s]{'TP': 3074, 'FP': 466, 'FN': 93, 'TN': 26660}
              precision    recall  f1-score   support

         LOC       0.82      0.93      0.87       279
         ORG       0.81      0.88      0.84       786
      PESSOA       0.84      0.97      0.90       323

   micro avg       0.82      0.91      0.86      1388
   macro avg       0.82      0.92      0.87      1388
weighted avg       0.82      0.91      0.86      1388

C:\Users\aceite\anaconda3\envs\ner-noticias-mapa\lib\site-packages\sklearn\utils\validation.py:70: FutureWarning: Pass labels=['B-LOC', 'B-ORG', 'B-PESSOA', 'I-LOC', 'I-ORG', 'I-PESSOA', 'O'] as keyword args. From version 1.0 (renaming of 0.25) passing these as positional arguments will result in an error
  warnings.warn(f"Pass {args_msg} as keyword args. From version "
              precision    recall  f1-score   support

       B-LOC       0.83      0.93      0.88       277
       B-ORG       0.89      0.92      0.90       782
    B-PESSOA       0.87      0.98      0.92       322
       I-LOC       0.81      0.94      0.87       154
       I-ORG       0.88      0.92      0.90      1312
    I-PESSOA       0.85      0.99      0.92       434
           O       1.00      0.99      0.99     27012

    accuracy                           0.98     30293
   macro avg       0.88      0.95      0.91     30293
weighted avg       0.98      0.98      0.98     30293

f1 0.8600682593856656 f1_masked 0.8786930830726452
{'eval_loss': 0.06997929513454437, 'eval_accuracy_score': 0.981546892021259, 'eval_precision': 0.8171206225680934, 'eval_recall': 0.9077809798270894, 'eval_f1': 0.8600682593856656, 'eval_f1_masked': 0.8786930830726452, 'eval_runtime': 5.1249, 'eval_samples_per_second': 19.512, 'epoch': 3.0}
                                                  
 10%|█         | 402/4020 [03:27<25:06,  2.40it/s]
100%|██████████| 34/34 [00:05<00:00, 10.44it/s]
                                               Saving model checkpoint to ./results\checkpoint-402
Configuration saved in ./results\checkpoint-402\config.json
Model weights saved in ./results\checkpoint-402\pytorch_model.bin
 10%|█         | 410/4020 [03:34<40:09,  1.50it/s]{'loss': 0.0593, 'learning_rate': 4.1e-05, 'epoch': 3.06}
 10%|█         | 420/4020 [03:39<26:55,  2.23it/s]{'loss': 0.029, 'learning_rate': 4.2e-05, 'epoch': 3.13}
 11%|█         | 430/4020 [03:43<26:28,  2.26it/s]{'loss': 0.0191, 'learning_rate': 4.3e-05, 'epoch': 3.21}
 11%|█         | 440/4020 [03:48<26:11,  2.28it/s]{'loss': 0.0462, 'learning_rate': 4.4000000000000006e-05, 'epoch': 3.28}
 11%|█         | 450/4020 [03:52<26:15,  2.27it/s]{'loss': 0.0326, 'learning_rate': 4.5e-05, 'epoch': 3.36}
 11%|█▏        | 460/4020 [03:57<25:56,  2.29it/s]{'loss': 0.0324, 'learning_rate': 4.600000000000001e-05, 'epoch': 3.43}
 12%|█▏        | 470/4020 [04:01<27:17,  2.17it/s]{'loss': 0.0817, 'learning_rate': 4.7e-05, 'epoch': 3.51}
 12%|█▏        | 480/4020 [04:06<27:05,  2.18it/s]{'loss': 0.0223, 'learning_rate': 4.8e-05, 'epoch': 3.58}
 12%|█▏        | 490/4020 [04:10<25:56,  2.27it/s]{'loss': 0.0307, 'learning_rate': 4.9e-05, 'epoch': 3.66}
 12%|█▏        | 500/4020 [04:15<27:08,  2.16it/s]{'loss': 0.0405, 'learning_rate': 5e-05, 'epoch': 3.73}
 13%|█▎        | 510/4020 [04:19<25:48,  2.27it/s]{'loss': 0.0343, 'learning_rate': 4.985795454545455e-05, 'epoch': 3.81}
 13%|█▎        | 520/4020 [04:24<27:06,  2.15it/s]{'loss': 0.0616, 'learning_rate': 4.971590909090909e-05, 'epoch': 3.88}
 13%|█▎        | 530/4020 [04:28<26:30,  2.19it/s]{'loss': 0.0941, 'learning_rate': 4.957386363636364e-05, 'epoch': 3.96}
 13%|█▎        | 536/4020 [04:31<23:40,  2.45it/s]***** Running Evaluation *****
  Num examples = 100
  Batch size = 3

  0%|          | 0/34 [00:00<?, ?it/s]
  9%|▉         | 3/34 [00:00<00:01, 17.46it/s]
 15%|█▍        | 5/34 [00:00<00:02, 13.31it/s]
 21%|██        | 7/34 [00:00<00:02, 12.57it/s]
 26%|██▋       | 9/34 [00:00<00:02, 11.80it/s]
 32%|███▏      | 11/34 [00:00<00:01, 11.73it/s]
 38%|███▊      | 13/34 [00:01<00:01, 11.36it/s]
 44%|████▍     | 15/34 [00:01<00:01, 11.45it/s]
 50%|█████     | 17/34 [00:01<00:01, 11.19it/s]
 56%|█████▌    | 19/34 [00:01<00:01, 11.33it/s]
 62%|██████▏   | 21/34 [00:01<00:01, 11.11it/s]
 68%|██████▊   | 23/34 [00:01<00:00, 11.27it/s]
 74%|███████▎  | 25/34 [00:02<00:00, 11.08it/s]
 79%|███████▉  | 27/34 [00:02<00:00, 11.22it/s]
 85%|████████▌ | 29/34 [00:02<00:00, 11.07it/s]
 91%|█████████ | 31/34 [00:02<00:00, 11.23it/s]
 97%|█████████▋| 33/34 [00:02<00:00, 11.06it/s]{'TP': 3064, 'FP': 325, 'FN': 142, 'TN': 26762}
C:\Users\aceite\anaconda3\envs\ner-noticias-mapa\lib\site-packages\sklearn\utils\validation.py:70: FutureWarning: Pass labels=['B-LOC', 'B-ORG', 'B-PESSOA', 'I-LOC', 'I-ORG', 'I-PESSOA', 'O'] as keyword args. From version 1.0 (renaming of 0.25) passing these as positional arguments will result in an error
  warnings.warn(f"Pass {args_msg} as keyword args. From version "
              precision    recall  f1-score   support

         LOC       0.81      0.94      0.87       279
         ORG       0.84      0.90      0.87       786
      PESSOA       0.84      0.94      0.89       323

   micro avg       0.83      0.92      0.87      1388
   macro avg       0.83      0.92      0.87      1388
weighted avg       0.83      0.92      0.87      1388

              precision    recall  f1-score   support

       B-LOC       0.84      0.95      0.89       277
       B-ORG       0.89      0.94      0.92       782
    B-PESSOA       0.88      0.98      0.93       322
       I-LOC       0.77      0.95      0.85       154
       I-ORG       0.94      0.91      0.92      1312
    I-PESSOA       0.93      0.96      0.95       434
           O       0.99      0.99      0.99     27012

    accuracy                           0.98     30293
   macro avg       0.89      0.95      0.92     30293
weighted avg       0.99      0.98      0.98     30293

f1 0.872041166380789 f1_masked 0.8838015955601803
                                                  
 13%|█▎        | 536/4020 [04:36<23:40,  2.45it/s]
100%|██████████| 34/34 [00:04<00:00, 11.06it/s]
                                               Saving model checkpoint to ./results\checkpoint-536
Configuration saved in ./results\checkpoint-536\config.json
{'eval_loss': 0.061319831758737564, 'eval_accuracy_score': 0.9845838972699964, 'eval_precision': 0.8323510150622135, 'eval_recall': 0.9157060518731989, 'eval_f1': 0.872041166380789, 'eval_f1_masked': 0.8838015955601803, 'eval_runtime': 4.9064, 'eval_samples_per_second': 20.381, 'epoch': 4.0}
Model weights saved in ./results\checkpoint-536\pytorch_model.bin
 13%|█▎        | 540/4020 [04:42<1:18:37,  1.36s/it]{'loss': 0.0198, 'learning_rate': 4.943181818181818e-05, 'epoch': 4.03}
 14%|█▎        | 550/4020 [04:46<27:28,  2.10it/s]{'loss': 0.0284, 'learning_rate': 4.9289772727272735e-05, 'epoch': 4.1}
 14%|█▍        | 560/4020 [04:51<26:08,  2.21it/s]{'loss': 0.0259, 'learning_rate': 4.914772727272727e-05, 'epoch': 4.18}
 14%|█▍        | 570/4020 [04:55<25:32,  2.25it/s]{'loss': 0.0363, 'learning_rate': 4.900568181818182e-05, 'epoch': 4.25}
 14%|█▍        | 580/4020 [05:00<25:19,  2.26it/s]{'loss': 0.0113, 'learning_rate': 4.886363636363637e-05, 'epoch': 4.33}
 15%|█▍        | 590/4020 [05:04<25:22,  2.25it/s]{'loss': 0.0273, 'learning_rate': 4.8721590909090915e-05, 'epoch': 4.4}
 15%|█▍        | 600/4020 [05:08<25:24,  2.24it/s]{'loss': 0.0152, 'learning_rate': 4.857954545454545e-05, 'epoch': 4.48}
 15%|█▌        | 610/4020 [05:13<25:04,  2.27it/s]{'loss': 0.0754, 'learning_rate': 4.8437500000000005e-05, 'epoch': 4.55}
 15%|█▌        | 620/4020 [05:17<24:44,  2.29it/s]{'loss': 0.0646, 'learning_rate': 4.829545454545455e-05, 'epoch': 4.63}
 16%|█▌        | 630/4020 [05:22<24:42,  2.29it/s]{'loss': 0.1035, 'learning_rate': 4.815340909090909e-05, 'epoch': 4.7}
 16%|█▌        | 640/4020 [05:26<24:59,  2.25it/s]{'loss': 0.2084, 'learning_rate': 4.801136363636364e-05, 'epoch': 4.78}
 16%|█▌        | 650/4020 [05:30<24:28,  2.29it/s]{'loss': 0.0193, 'learning_rate': 4.7869318181818185e-05, 'epoch': 4.85}
 16%|█▋        | 660/4020 [05:35<24:14,  2.31it/s]{'loss': 0.0287, 'learning_rate': 4.772727272727273e-05, 'epoch': 4.93}
 17%|█▋        | 670/4020 [05:39<23:03,  2.42it/s]***** Running Evaluation *****
{'loss': 0.0292, 'learning_rate': 4.7585227272727276e-05, 'epoch': 5.0}
  Num examples = 100
  Batch size = 3

  0%|          | 0/34 [00:00<?, ?it/s]
  9%|▉         | 3/34 [00:00<00:01, 16.03it/s]
 15%|█▍        | 5/34 [00:00<00:02, 13.53it/s]
 21%|██        | 7/34 [00:00<00:02, 12.19it/s]
 26%|██▋       | 9/34 [00:00<00:02, 11.00it/s]
 32%|███▏      | 11/34 [00:00<00:02, 10.82it/s]
 38%|███▊      | 13/34 [00:01<00:01, 10.65it/s]
 44%|████▍     | 15/34 [00:01<00:01, 10.67it/s]
 50%|█████     | 17/34 [00:01<00:01, 10.99it/s]
 56%|█████▌    | 19/34 [00:01<00:01, 10.72it/s]
 62%|██████▏   | 21/34 [00:01<00:01, 10.77it/s]
 68%|██████▊   | 23/34 [00:02<00:01, 10.78it/s]
 74%|███████▎  | 25/34 [00:02<00:00, 10.84it/s]
 79%|███████▉  | 27/34 [00:02<00:00, 10.69it/s]
 85%|████████▌ | 29/34 [00:02<00:00, 10.50it/s]
 91%|█████████ | 31/34 [00:02<00:00, 10.44it/s]
 97%|█████████▋| 33/34 [00:03<00:00, 10.57it/s]{'TP': 3132, 'FP': 390, 'FN': 76, 'TN': 26695}
C:\Users\aceite\anaconda3\envs\ner-noticias-mapa\lib\site-packages\sklearn\utils\validation.py:70: FutureWarning: Pass labels=['B-LOC', 'B-ORG', 'B-PESSOA', 'I-LOC', 'I-ORG', 'I-PESSOA', 'O'] as keyword args. From version 1.0 (renaming of 0.25) passing these as positional arguments will result in an error
  warnings.warn(f"Pass {args_msg} as keyword args. From version "
              precision    recall  f1-score   support

         LOC       0.84      0.93      0.89       279
         ORG       0.85      0.90      0.87       786
      PESSOA       0.86      0.97      0.91       323

   micro avg       0.85      0.92      0.88      1388
   macro avg       0.85      0.93      0.89      1388
weighted avg       0.85      0.92      0.88      1388

              precision    recall  f1-score   support

       B-LOC       0.87      0.94      0.90       277
       B-ORG       0.90      0.94      0.92       782
    B-PESSOA       0.87      0.98      0.92       322
       I-LOC       0.83      0.94      0.88       154
       I-ORG       0.89      0.95      0.92      1312
    I-PESSOA       0.91      0.99      0.95       434
           O       1.00      0.99      0.99     27012

    accuracy                           0.98     30293
   macro avg       0.90      0.96      0.93     30293
weighted avg       0.99      0.98      0.98     30293

f1 0.8845225784212339 f1_masked 0.893691181596375
                                                  
 17%|█▋        | 670/4020 [05:44<23:03,  2.42it/s]
100%|██████████| 34/34 [00:04<00:00, 10.57it/s]
                                               Saving model checkpoint to ./results\checkpoint-670
Configuration saved in ./results\checkpoint-670\config.json
{'eval_loss': 0.07112973928451538, 'eval_accuracy_score': 0.9846169081966131, 'eval_precision': 0.8479841374752148, 'eval_recall': 0.9243515850144092, 'eval_f1': 0.8845225784212339, 'eval_f1_masked': 0.893691181596375, 'eval_runtime': 5.0717, 'eval_samples_per_second': 19.717, 'epoch': 5.0}
Model weights saved in ./results\checkpoint-670\pytorch_model.bin
 17%|█▋        | 680/4020 [05:53<31:20,  1.78it/s]{'loss': 0.0364, 'learning_rate': 4.744318181818182e-05, 'epoch': 5.07}
 17%|█▋        | 690/4020 [05:57<25:24,  2.18it/s]{'loss': 0.0227, 'learning_rate': 4.7301136363636366e-05, 'epoch': 5.15}
 17%|█▋        | 700/4020 [06:02<25:22,  2.18it/s]{'loss': 0.0086, 'learning_rate': 4.715909090909091e-05, 'epoch': 5.22}
 18%|█▊        | 710/4020 [06:06<24:27,  2.25it/s]{'loss': 0.0186, 'learning_rate': 4.7017045454545456e-05, 'epoch': 5.3}
 18%|█▊        | 720/4020 [06:11<24:15,  2.27it/s]{'loss': 0.0236, 'learning_rate': 4.6875e-05, 'epoch': 5.37}
 18%|█▊        | 730/4020 [06:15<23:59,  2.28it/s]{'loss': 0.0115, 'learning_rate': 4.6732954545454546e-05, 'epoch': 5.45}
 18%|█▊        | 740/4020 [06:20<23:56,  2.28it/s]{'loss': 0.017, 'learning_rate': 4.659090909090909e-05, 'epoch': 5.52}
 19%|█▊        | 750/4020 [06:24<23:56,  2.28it/s]{'loss': 0.0402, 'learning_rate': 4.6448863636363636e-05, 'epoch': 5.6}
 19%|█▉        | 760/4020 [06:29<23:46,  2.29it/s]{'loss': 0.0558, 'learning_rate': 4.630681818181818e-05, 'epoch': 5.67}
 19%|█▉        | 770/4020 [06:33<23:45,  2.28it/s]{'loss': 0.0109, 'learning_rate': 4.616477272727273e-05, 'epoch': 5.75}
 19%|█▉        | 780/4020 [06:37<23:35,  2.29it/s]{'loss': 0.0174, 'learning_rate': 4.602272727272727e-05, 'epoch': 5.82}
 20%|█▉        | 790/4020 [06:42<23:50,  2.26it/s]{'loss': 0.0723, 'learning_rate': 4.5880681818181817e-05, 'epoch': 5.9}
 20%|█▉        | 800/4020 [06:46<23:49,  2.25it/s]{'loss': 0.0414, 'learning_rate': 4.573863636363637e-05, 'epoch': 5.97}
 20%|██        | 804/4020 [06:48<22:06,  2.42it/s]***** Running Evaluation *****
  Num examples = 100
  Batch size = 3

  0%|          | 0/34 [00:00<?, ?it/s]
  9%|▉         | 3/34 [00:00<00:01, 17.45it/s]
 15%|█▍        | 5/34 [00:00<00:02, 13.32it/s]
 21%|██        | 7/34 [00:00<00:02, 12.09it/s]
 26%|██▋       | 9/34 [00:00<00:02, 11.92it/s]
 32%|███▏      | 11/34 [00:00<00:02, 11.45it/s]
 38%|███▊      | 13/34 [00:01<00:01, 11.18it/s]
 44%|████▍     | 15/34 [00:01<00:01, 11.01it/s]
 50%|█████     | 17/34 [00:01<00:01, 10.90it/s]
 56%|█████▌    | 19/34 [00:01<00:01, 11.12it/s]
 62%|██████▏   | 21/34 [00:01<00:01, 10.98it/s]
 68%|██████▊   | 23/34 [00:02<00:01, 10.88it/s]
 74%|███████▎  | 25/34 [00:02<00:00, 11.10it/s]
 79%|███████▉  | 27/34 [00:02<00:00, 10.97it/s]
 85%|████████▌ | 29/34 [00:02<00:00, 10.86it/s]
 91%|█████████ | 31/34 [00:02<00:00, 10.75it/s]
 97%|█████████▋| 33/34 [00:02<00:00, 11.07it/s]{'TP': 3074, 'FP': 306, 'FN': 146, 'TN': 26767}
C:\Users\aceite\anaconda3\envs\ner-noticias-mapa\lib\site-packages\sklearn\utils\validation.py:70: FutureWarning: Pass labels=['B-LOC', 'B-ORG', 'B-PESSOA', 'I-LOC', 'I-ORG', 'I-PESSOA', 'O'] as keyword args. From version 1.0 (renaming of 0.25) passing these as positional arguments will result in an error
  warnings.warn(f"Pass {args_msg} as keyword args. From version "
              precision    recall  f1-score   support

         LOC       0.77      0.92      0.84       279
         ORG       0.85      0.91      0.88       786
      PESSOA       0.91      0.90      0.90       323

   micro avg       0.85      0.91      0.88      1388
   macro avg       0.84      0.91      0.87      1388
weighted avg       0.85      0.91      0.88      1388

              precision    recall  f1-score   support

       B-LOC       0.79      0.93      0.85       277
       B-ORG       0.90      0.95      0.93       782
    B-PESSOA       0.95      0.92      0.93       322
       I-LOC       0.79      0.90      0.84       154
       I-ORG       0.93      0.93      0.93      1312
    I-PESSOA       0.97      0.97      0.97       434
           O       0.99      0.99      0.99     27012

    accuracy                           0.99     30293
   macro avg       0.90      0.94      0.92     30293
weighted avg       0.99      0.99      0.99     30293

f1 0.8768643773846688 f1_masked 0.884063047285464
{'eval_loss': 0.05777430534362793, 'eval_accuracy_score': 0.985079061169247, 'eval_precision': 0.8454849498327759, 'eval_recall': 0.9106628242074928, 'eval_f1': 0.8768643773846688, 'eval_f1_masked': 0.884063047285464, 'eval_runtime': 4.9222, 'eval_samples_per_second': 20.316, 'epoch': 6.0}
                                                  
 20%|██        | 804/4020 [06:53<22:06,  2.42it/s]
100%|██████████| 34/34 [00:04<00:00, 11.07it/s]
                                               Saving model checkpoint to ./results\checkpoint-804
Configuration saved in ./results\checkpoint-804\config.json
Model weights saved in ./results\checkpoint-804\pytorch_model.bin
 20%|██        | 810/4020 [07:00<47:37,  1.12it/s]{'loss': 0.0163, 'learning_rate': 4.5596590909090913e-05, 'epoch': 6.04}
 20%|██        | 820/4020 [07:04<24:13,  2.20it/s]{'loss': 0.0067, 'learning_rate': 4.545454545454546e-05, 'epoch': 6.12}
 21%|██        | 830/4020 [07:08<23:13,  2.29it/s]{'loss': 0.0133, 'learning_rate': 4.5312500000000004e-05, 'epoch': 6.19}
 21%|██        | 840/4020 [07:13<23:01,  2.30it/s]{'loss': 0.0374, 'learning_rate': 4.517045454545455e-05, 'epoch': 6.27}
 21%|██        | 850/4020 [07:17<23:02,  2.29it/s]{'loss': 0.021, 'learning_rate': 4.5028409090909094e-05, 'epoch': 6.34}
 21%|██▏       | 860/4020 [07:22<23:54,  2.20it/s]{'loss': 0.0311, 'learning_rate': 4.488636363636364e-05, 'epoch': 6.42}
 22%|██▏       | 870/4020 [07:26<24:13,  2.17it/s]{'loss': 0.0131, 'learning_rate': 4.4744318181818184e-05, 'epoch': 6.49}
 22%|██▏       | 880/4020 [07:31<23:03,  2.27it/s]{'loss': 0.0447, 'learning_rate': 4.460227272727273e-05, 'epoch': 6.57}
 22%|██▏       | 890/4020 [07:35<23:05,  2.26it/s]{'loss': 0.0092, 'learning_rate': 4.4460227272727274e-05, 'epoch': 6.64}
 22%|██▏       | 900/4020 [07:40<23:39,  2.20it/s]{'loss': 0.0289, 'learning_rate': 4.431818181818182e-05, 'epoch': 6.72}
 23%|██▎       | 910/4020 [07:44<24:03,  2.15it/s]{'loss': 0.0161, 'learning_rate': 4.4176136363636364e-05, 'epoch': 6.79}
 23%|██▎       | 920/4020 [07:49<23:14,  2.22it/s]{'loss': 0.0111, 'learning_rate': 4.4034090909090916e-05, 'epoch': 6.87}
 23%|██▎       | 930/4020 [07:53<22:25,  2.30it/s]{'loss': 0.0155, 'learning_rate': 4.3892045454545454e-05, 'epoch': 6.94}
 23%|██▎       | 938/4020 [07:57<20:59,  2.45it/s]***** Running Evaluation *****
  Num examples = 100
  Batch size = 3

  0%|          | 0/34 [00:00<?, ?it/s]
  9%|▉         | 3/34 [00:00<00:01, 15.96it/s]
 15%|█▍        | 5/34 [00:00<00:02, 12.85it/s]
 21%|██        | 7/34 [00:00<00:02, 11.86it/s]
 26%|██▋       | 9/34 [00:00<00:02, 11.78it/s]
 32%|███▏      | 11/34 [00:00<00:02, 11.37it/s]
 38%|███▊      | 13/34 [00:01<00:01, 11.13it/s]
 44%|████▍     | 15/34 [00:01<00:01, 10.98it/s]
 50%|█████     | 17/34 [00:01<00:01, 11.18it/s]
 56%|█████▌    | 19/34 [00:01<00:01, 11.01it/s]
 62%|██████▏   | 21/34 [00:01<00:01, 10.90it/s]
 68%|██████▊   | 23/34 [00:02<00:01, 10.83it/s]
 74%|███████▎  | 25/34 [00:02<00:00, 11.06it/s]
 79%|███████▉  | 27/34 [00:02<00:00, 10.94it/s]
 85%|████████▌ | 29/34 [00:02<00:00, 10.85it/s]
 91%|█████████ | 31/34 [00:02<00:00, 10.80it/s]
 97%|█████████▋| 33/34 [00:02<00:00, 11.04it/s]{'TP': 3061, 'FP': 323, 'FN': 140, 'TN': 26769}
              precision    recall  f1-score   support

         LOC       0.78      0.93      0.85       279
         ORG       0.84      0.88      0.86       786
      PESSOA       0.88      0.96      0.92       323

   micro avg       0.84      0.91      0.87      1388
   macro avg       0.83      0.92      0.88      1388
weighted avg       0.84      0.91      0.87      1388

C:\Users\aceite\anaconda3\envs\ner-noticias-mapa\lib\site-packages\sklearn\utils\validation.py:70: FutureWarning: Pass labels=['B-LOC', 'B-ORG', 'B-PESSOA', 'I-LOC', 'I-ORG', 'I-PESSOA', 'O'] as keyword args. From version 1.0 (renaming of 0.25) passing these as positional arguments will result in an error
  warnings.warn(f"Pass {args_msg} as keyword args. From version "
              precision    recall  f1-score   support

       B-LOC       0.84      0.94      0.88       277
       B-ORG       0.91      0.93      0.92       782
    B-PESSOA       0.92      0.97      0.94       322
       I-LOC       0.76      0.97      0.85       154
       I-ORG       0.93      0.90      0.92      1312
    I-PESSOA       0.92      0.98      0.95       434
           O       0.99      0.99      0.99     27012

    accuracy                           0.98     30293
   macro avg       0.90      0.95      0.92     30293
weighted avg       0.99      0.98      0.98     30293

f1 0.8724507431731766 f1_masked 0.8941259233204362
                                                  
 23%|██▎       | 938/4020 [08:01<20:59,  2.45it/s]
100%|██████████| 34/34 [00:04<00:00, 11.04it/s]
                                               Saving model checkpoint to ./results\checkpoint-938
Configuration saved in ./results\checkpoint-938\config.json
{'eval_loss': 0.06303086876869202, 'eval_accuracy_score': 0.9847159409764632, 'eval_precision': 0.8385382059800665, 'eval_recall': 0.909221902017291, 'eval_f1': 0.8724507431731766, 'eval_f1_masked': 0.8941259233204362, 'eval_runtime': 4.9061, 'eval_samples_per_second': 20.383, 'epoch': 7.0}
Model weights saved in ./results\checkpoint-938\pytorch_model.bin
 23%|██▎       | 940/4020 [08:07<1:59:56,  2.34s/it]{'loss': 0.0137, 'learning_rate': 4.375e-05, 'epoch': 7.01}
 24%|██▎       | 950/4020 [08:11<26:07,  1.96it/s]{'loss': 0.0111, 'learning_rate': 4.360795454545455e-05, 'epoch': 7.09}
 24%|██▍       | 960/4020 [08:16<22:40,  2.25it/s]{'loss': 0.0047, 'learning_rate': 4.346590909090909e-05, 'epoch': 7.16}
 24%|██▍       | 970/4020 [08:20<22:18,  2.28it/s]{'loss': 0.0092, 'learning_rate': 4.3323863636363635e-05, 'epoch': 7.24}
 24%|██▍       | 980/4020 [08:24<22:15,  2.28it/s]{'loss': 0.0317, 'learning_rate': 4.318181818181819e-05, 'epoch': 7.31}
 25%|██▍       | 990/4020 [08:29<22:08,  2.28it/s]{'loss': 0.0096, 'learning_rate': 4.303977272727273e-05, 'epoch': 7.39}
 25%|██▍       | 1000/4020 [08:33<22:12,  2.27it/s]{'loss': 0.0067, 'learning_rate': 4.289772727272727e-05, 'epoch': 7.46}
 25%|██▌       | 1010/4020 [08:38<22:05,  2.27it/s]{'loss': 0.0095, 'learning_rate': 4.275568181818182e-05, 'epoch': 7.54}
 25%|██▌       | 1020/4020 [08:42<22:03,  2.27it/s]{'loss': 0.0062, 'learning_rate': 4.261363636363637e-05, 'epoch': 7.61}
 26%|██▌       | 1030/4020 [08:46<22:05,  2.26it/s]{'loss': 0.0201, 'learning_rate': 4.247159090909091e-05, 'epoch': 7.69}
 26%|██▌       | 1040/4020 [08:51<21:52,  2.27it/s]{'loss': 0.0292, 'learning_rate': 4.232954545454546e-05, 'epoch': 7.76}
 26%|██▌       | 1050/4020 [08:55<21:53,  2.26it/s]{'loss': 0.0232, 'learning_rate': 4.21875e-05, 'epoch': 7.84}
 26%|██▋       | 1060/4020 [09:00<21:46,  2.26it/s]{'loss': 0.0086, 'learning_rate': 4.204545454545455e-05, 'epoch': 7.91}
 27%|██▋       | 1070/4020 [09:04<21:36,  2.27it/s]{'loss': 0.0113, 'learning_rate': 4.190340909090909e-05, 'epoch': 7.99}
 27%|██▋       | 1072/4020 [09:05<20:34,  2.39it/s]***** Running Evaluation *****
  Num examples = 100
  Batch size = 3

  0%|          | 0/34 [00:00<?, ?it/s]
  9%|▉         | 3/34 [00:00<00:01, 17.35it/s]
 15%|█▍        | 5/34 [00:00<00:02, 13.29it/s]
 21%|██        | 7/34 [00:00<00:02, 12.12it/s]
 26%|██▋       | 9/34 [00:00<00:02, 11.53it/s]
 32%|███▏      | 11/34 [00:00<00:02, 10.88it/s]
 38%|███▊      | 13/34 [00:01<00:01, 10.81it/s]
 44%|████▍     | 15/34 [00:01<00:01, 10.48it/s]
 50%|█████     | 17/34 [00:01<00:01, 10.54it/s]
 56%|█████▌    | 19/34 [00:01<00:01, 10.58it/s]
 62%|██████▏   | 21/34 [00:01<00:01, 10.60it/s]
 68%|██████▊   | 23/34 [00:02<00:01, 10.63it/s]
 74%|███████▎  | 25/34 [00:02<00:00, 10.64it/s]
 79%|███████▉  | 27/34 [00:02<00:00, 10.65it/s]
 85%|████████▌ | 29/34 [00:02<00:00, 10.92it/s]
 91%|█████████ | 31/34 [00:02<00:00, 10.85it/s]
 97%|█████████▋| 33/34 [00:02<00:00, 10.79it/s]{'TP': 3113, 'FP': 371, 'FN': 105, 'TN': 26704}
              precision    recall  f1-score   support

         LOC       0.86      0.89      0.88       279
         ORG       0.86      0.90      0.88       786
      PESSOA       0.86      0.97      0.91       323

   micro avg       0.86      0.91      0.89      1388
   macro avg       0.86      0.92      0.89      1388
weighted avg       0.86      0.91      0.88      1388

C:\Users\aceite\anaconda3\envs\ner-noticias-mapa\lib\site-packages\sklearn\utils\validation.py:70: FutureWarning: Pass labels=['B-LOC', 'B-ORG', 'B-PESSOA', 'I-LOC', 'I-ORG', 'I-PESSOA', 'O'] as keyword args. From version 1.0 (renaming of 0.25) passing these as positional arguments will result in an error
  warnings.warn(f"Pass {args_msg} as keyword args. From version "
              precision    recall  f1-score   support

       B-LOC       0.88      0.90      0.89       277
       B-ORG       0.91      0.93      0.92       782
    B-PESSOA       0.89      0.98      0.93       322
       I-LOC       0.88      0.93      0.90       154
       I-ORG       0.89      0.95      0.92      1312
    I-PESSOA       0.91      0.99      0.94       434
           O       1.00      0.99      0.99     27012

    accuracy                           0.98     30293
   macro avg       0.91      0.95      0.93     30293
weighted avg       0.98      0.98      0.98     30293

f1 0.8850052429220552 f1_masked 0.8924274593064402
                                                   
 27%|██▋       | 1072/4020 [09:10<20:34,  2.39it/s]
100%|██████████| 34/34 [00:04<00:00, 10.79it/s]
                                               Saving model checkpoint to ./results\checkpoint-1072
Configuration saved in ./results\checkpoint-1072\config.json
{'eval_loss': 0.0809762105345726, 'eval_accuracy_score': 0.984286798930446, 'eval_precision': 0.8594704684317719, 'eval_recall': 0.9121037463976945, 'eval_f1': 0.8850052429220552, 'eval_f1_masked': 0.8924274593064402, 'eval_runtime': 4.9983, 'eval_samples_per_second': 20.007, 'epoch': 8.0}
Model weights saved in ./results\checkpoint-1072\pytorch_model.bin
 27%|██▋       | 1080/4020 [09:18<32:55,  1.49it/s]{'loss': 0.0073, 'learning_rate': 4.176136363636364e-05, 'epoch': 8.06}
 27%|██▋       | 1090/4020 [09:22<22:49,  2.14it/s]{'loss': 0.0241, 'learning_rate': 4.161931818181818e-05, 'epoch': 8.13}
 27%|██▋       | 1100/4020 [09:27<22:07,  2.20it/s]{'loss': 0.0105, 'learning_rate': 4.1477272727272734e-05, 'epoch': 8.21}
 28%|██▊       | 1110/4020 [09:31<22:13,  2.18it/s]{'loss': 0.0121, 'learning_rate': 4.133522727272727e-05, 'epoch': 8.28}
 28%|██▊       | 1120/4020 [09:36<21:33,  2.24it/s]{'loss': 0.0368, 'learning_rate': 4.119318181818182e-05, 'epoch': 8.36}
 28%|██▊       | 1130/4020 [09:40<21:45,  2.21it/s]{'loss': 0.0161, 'learning_rate': 4.105113636363637e-05, 'epoch': 8.43}
 28%|██▊       | 1140/4020 [09:45<21:09,  2.27it/s]{'loss': 0.0211, 'learning_rate': 4.0909090909090915e-05, 'epoch': 8.51}
 29%|██▊       | 1150/4020 [09:49<21:02,  2.27it/s]{'loss': 0.0135, 'learning_rate': 4.076704545454545e-05, 'epoch': 8.58}
 29%|██▉       | 1160/4020 [09:54<20:56,  2.28it/s]{'loss': 0.0682, 'learning_rate': 4.0625000000000005e-05, 'epoch': 8.66}
 29%|██▉       | 1170/4020 [09:58<21:42,  2.19it/s]{'loss': 0.0071, 'learning_rate': 4.048295454545455e-05, 'epoch': 8.73}
 29%|██▉       | 1180/4020 [10:02<20:38,  2.29it/s]{'loss': 0.0043, 'learning_rate': 4.034090909090909e-05, 'epoch': 8.81}
 30%|██▉       | 1190/4020 [10:07<20:40,  2.28it/s]{'loss': 0.0045, 'learning_rate': 4.019886363636364e-05, 'epoch': 8.88}
 30%|██▉       | 1200/4020 [10:11<20:53,  2.25it/s]{'loss': 0.0056, 'learning_rate': 4.0056818181818185e-05, 'epoch': 8.96}
 30%|███       | 1206/4020 [10:14<19:29,  2.41it/s]***** Running Evaluation *****
  Num examples = 100
  Batch size = 3

  0%|          | 0/34 [00:00<?, ?it/s]
  6%|▌         | 2/34 [00:00<00:01, 19.56it/s]
 12%|█▏        | 4/34 [00:00<00:02, 13.90it/s]
 18%|█▊        | 6/34 [00:00<00:02, 12.77it/s]
 24%|██▎       | 8/34 [00:00<00:02, 11.85it/s]
 29%|██▉       | 10/34 [00:00<00:02, 11.77it/s]
 35%|███▌      | 12/34 [00:00<00:01, 11.37it/s]
 41%|████      | 14/34 [00:01<00:01, 11.46it/s]
 47%|████▋     | 16/34 [00:01<00:01, 11.19it/s]
 53%|█████▎    | 18/34 [00:01<00:01, 11.17it/s]
 59%|█████▉    | 20/34 [00:01<00:01, 11.29it/s]
 65%|██████▍   | 22/34 [00:01<00:01, 11.09it/s]
 71%|███████   | 24/34 [00:02<00:00, 11.25it/s]
 76%|███████▋  | 26/34 [00:02<00:00, 11.37it/s]
 82%|████████▏ | 28/34 [00:02<00:00, 11.15it/s]
 88%|████████▊ | 30/34 [00:02<00:00, 11.14it/s]
 94%|█████████▍| 32/34 [00:02<00:00, 11.11it/s]
100%|██████████| 34/34 [00:02<00:00, 11.89it/s]{'TP': 3051, 'FP': 295, 'FN': 179, 'TN': 26768}
C:\Users\aceite\anaconda3\envs\ner-noticias-mapa\lib\site-packages\sklearn\utils\validation.py:70: FutureWarning: Pass labels=['B-LOC', 'B-ORG', 'B-PESSOA', 'I-LOC', 'I-ORG', 'I-PESSOA', 'O'] as keyword args. From version 1.0 (renaming of 0.25) passing these as positional arguments will result in an error
  warnings.warn(f"Pass {args_msg} as keyword args. From version "
              precision    recall  f1-score   support

         LOC       0.85      0.87      0.86       279
         ORG       0.87      0.88      0.87       786
      PESSOA       0.87      0.98      0.92       323

   micro avg       0.86      0.90      0.88      1388
   macro avg       0.86      0.91      0.88      1388
weighted avg       0.86      0.90      0.88      1388

              precision    recall  f1-score   support

       B-LOC       0.87      0.88      0.88       277
       B-ORG       0.92      0.92      0.92       782
    B-PESSOA       0.88      0.99      0.93       322
       I-LOC       0.87      0.92      0.90       154
       I-ORG       0.93      0.91      0.92      1312
    I-PESSOA       0.91      0.99      0.95       434
           O       0.99      0.99      0.99     27012

    accuracy                           0.98     30293
   macro avg       0.91      0.94      0.93     30293
weighted avg       0.98      0.98      0.98     30293

f1 0.8816901408450705 f1_masked 0.8896011396011396
{'eval_loss': 0.08132222294807434, 'eval_accuracy_score': 0.9843528207836794, 'eval_precision': 0.8622589531680441, 'eval_recall': 0.9020172910662824, 'eval_f1': 0.8816901408450705, 'eval_f1_masked': 0.8896011396011396, 'eval_runtime': 4.8419, 'eval_samples_per_second': 20.653, 'epoch': 9.0}
                                                   
 30%|███       | 1206/4020 [10:19<19:29,  2.41it/s]
100%|██████████| 34/34 [00:04<00:00, 11.89it/s]
                                               Saving model checkpoint to ./results\checkpoint-1206
Configuration saved in ./results\checkpoint-1206\config.json
Model weights saved in ./results\checkpoint-1206\pytorch_model.bin
 30%|███       | 1210/4020 [10:24<1:03:22,  1.35s/it]{'loss': 0.0117, 'learning_rate': 3.991477272727273e-05, 'epoch': 9.03}
 30%|███       | 1220/4020 [10:29<21:43,  2.15it/s]{'loss': 0.0038, 'learning_rate': 3.9772727272727275e-05, 'epoch': 9.1}
 31%|███       | 1230/4020 [10:33<20:38,  2.25it/s]{'loss': 0.0066, 'learning_rate': 3.963068181818182e-05, 'epoch': 9.18}
 31%|███       | 1240/4020 [10:38<20:19,  2.28it/s]{'loss': 0.0078, 'learning_rate': 3.9488636363636366e-05, 'epoch': 9.25}
 31%|███       | 1250/4020 [10:42<20:17,  2.28it/s]{'loss': 0.0136, 'learning_rate': 3.934659090909091e-05, 'epoch': 9.33}
 31%|███▏      | 1260/4020 [10:46<20:13,  2.27it/s]{'loss': 0.0057, 'learning_rate': 3.9204545454545456e-05, 'epoch': 9.4}
 32%|███▏      | 1270/4020 [10:51<20:12,  2.27it/s]{'loss': 0.0092, 'learning_rate': 3.90625e-05, 'epoch': 9.48}
 32%|███▏      | 1280/4020 [10:55<20:34,  2.22it/s]{'loss': 0.0045, 'learning_rate': 3.8920454545454546e-05, 'epoch': 9.55}
 32%|███▏      | 1290/4020 [11:00<20:40,  2.20it/s]{'loss': 0.0086, 'learning_rate': 3.877840909090909e-05, 'epoch': 9.63}
 32%|███▏      | 1300/4020 [11:04<20:01,  2.26it/s]{'loss': 0.0108, 'learning_rate': 3.8636363636363636e-05, 'epoch': 9.7}
 33%|███▎      | 1310/4020 [11:09<20:20,  2.22it/s]{'loss': 0.0419, 'learning_rate': 3.849431818181818e-05, 'epoch': 9.78}
 33%|███▎      | 1320/4020 [11:13<19:57,  2.26it/s]{'loss': 0.0098, 'learning_rate': 3.835227272727273e-05, 'epoch': 9.85}
 33%|███▎      | 1330/4020 [11:18<19:47,  2.26it/s]{'loss': 0.2012, 'learning_rate': 3.821022727272727e-05, 'epoch': 9.93}
 33%|███▎      | 1340/4020 [11:22<18:10,  2.46it/s]***** Running Evaluation *****
{'loss': 0.0016, 'learning_rate': 3.8068181818181816e-05, 'epoch': 10.0}
  Num examples = 100
  Batch size = 3

  0%|          | 0/34 [00:00<?, ?it/s]
  6%|▌         | 2/34 [00:00<00:01, 19.68it/s]
 12%|█▏        | 4/34 [00:00<00:02, 13.99it/s]
 18%|█▊        | 6/34 [00:00<00:02, 12.77it/s]
 24%|██▎       | 8/34 [00:00<00:02, 11.85it/s]
 29%|██▉       | 10/34 [00:00<00:02, 11.77it/s]
 35%|███▌      | 12/34 [00:00<00:01, 11.37it/s]
 41%|████      | 14/34 [00:01<00:01, 11.46it/s]
 47%|████▋     | 16/34 [00:01<00:01, 11.19it/s]
 53%|█████▎    | 18/34 [00:01<00:01, 11.17it/s]
 59%|█████▉    | 20/34 [00:01<00:01, 11.29it/s]
 65%|██████▍   | 22/34 [00:01<00:01, 11.09it/s]
 71%|███████   | 24/34 [00:02<00:00, 11.25it/s]
 76%|███████▋  | 26/34 [00:02<00:00, 11.07it/s]
 82%|████████▏ | 28/34 [00:02<00:00, 11.24it/s]
 88%|████████▊ | 30/34 [00:02<00:00, 11.35it/s]
 94%|█████████▍| 32/34 [00:02<00:00, 11.14it/s]
100%|██████████| 34/34 [00:02<00:00, 11.75it/s]{'TP': 3015, 'FP': 250, 'FN': 211, 'TN': 26817}
              precision    recall  f1-score   support

         LOC       0.84      0.94      0.89       279
         ORG       0.88      0.85      0.86       786
      PESSOA       0.86      0.96      0.91       323

   micro avg       0.87      0.89      0.88      1388
   macro avg       0.86      0.92      0.89      1388
weighted avg       0.87      0.89      0.88      1388

C:\Users\aceite\anaconda3\envs\ner-noticias-mapa\lib\site-packages\sklearn\utils\validation.py:70: FutureWarning: Pass labels=['B-LOC', 'B-ORG', 'B-PESSOA', 'I-LOC', 'I-ORG', 'I-PESSOA', 'O'] as keyword args. From version 1.0 (renaming of 0.25) passing these as positional arguments will result in an error
  warnings.warn(f"Pass {args_msg} as keyword args. From version "
              precision    recall  f1-score   support

       B-LOC       0.87      0.95      0.91       277
       B-ORG       0.93      0.89      0.91       782
    B-PESSOA       0.90      0.98      0.94       322
       I-LOC       0.87      0.93      0.90       154
       I-ORG       0.95      0.90      0.92      1312
    I-PESSOA       0.91      0.98      0.94       434
           O       0.99      0.99      0.99     27012

    accuracy                           0.98     30293
   macro avg       0.92      0.94      0.93     30293
weighted avg       0.98      0.98      0.98     30293

f1 0.8789492367767129 f1_masked 0.888888888888889
{'eval_loss': 0.08233615756034851, 'eval_accuracy_score': 0.9847819628296967, 'eval_precision': 0.8663400979706088, 'eval_recall': 0.8919308357348703, 'eval_f1': 0.8789492367767129, 'eval_f1_masked': 0.888888888888889, 'eval_runtime': 4.8411, 'eval_samples_per_second': 20.656, 'epoch': 10.0}
                                                   
 33%|███▎      | 1340/4020 [11:27<18:10,  2.46it/s]
100%|██████████| 34/34 [00:04<00:00, 11.75it/s]
                                               Saving model checkpoint to ./results\checkpoint-1340
Configuration saved in ./results\checkpoint-1340\config.json
Model weights saved in ./results\checkpoint-1340\pytorch_model.bin
 34%|███▎      | 1350/4020 [11:35<24:14,  1.84it/s]{'loss': 0.0042, 'learning_rate': 3.792613636363637e-05, 'epoch': 10.07}
 34%|███▍      | 1360/4020 [11:40<19:43,  2.25it/s]{'loss': 0.0059, 'learning_rate': 3.778409090909091e-05, 'epoch': 10.15}
 34%|███▍      | 1370/4020 [11:44<19:18,  2.29it/s]{'loss': 0.0028, 'learning_rate': 3.764204545454545e-05, 'epoch': 10.22}
 34%|███▍      | 1380/4020 [11:48<19:17,  2.28it/s]{'loss': 0.0048, 'learning_rate': 3.7500000000000003e-05, 'epoch': 10.3}
 35%|███▍      | 1390/4020 [11:53<19:09,  2.29it/s]{'loss': 0.0052, 'learning_rate': 3.735795454545455e-05, 'epoch': 10.37}
 35%|███▍      | 1400/4020 [11:57<19:04,  2.29it/s]{'loss': 0.0025, 'learning_rate': 3.721590909090909e-05, 'epoch': 10.45}
 35%|███▌      | 1410/4020 [12:01<19:03,  2.28it/s]{'loss': 0.0065, 'learning_rate': 3.707386363636364e-05, 'epoch': 10.52}
 35%|███▌      | 1420/4020 [12:06<18:59,  2.28it/s]{'loss': 0.0342, 'learning_rate': 3.6931818181818184e-05, 'epoch': 10.6}
 36%|███▌      | 1430/4020 [12:10<18:49,  2.29it/s]{'loss': 0.0068, 'learning_rate': 3.678977272727273e-05, 'epoch': 10.67}
 36%|███▌      | 1440/4020 [12:15<19:09,  2.24it/s]{'loss': 0.0135, 'learning_rate': 3.6647727272727274e-05, 'epoch': 10.75}
 36%|███▌      | 1450/4020 [12:19<18:50,  2.27it/s]{'loss': 0.0062, 'learning_rate': 3.650568181818182e-05, 'epoch': 10.82}
 36%|███▋      | 1460/4020 [12:23<18:47,  2.27it/s]{'loss': 0.0049, 'learning_rate': 3.6363636363636364e-05, 'epoch': 10.9}
 37%|███▋      | 1470/4020 [12:28<18:59,  2.24it/s]{'loss': 0.0238, 'learning_rate': 3.6221590909090916e-05, 'epoch': 10.97}
 37%|███▋      | 1474/4020 [12:29<17:25,  2.44it/s]***** Running Evaluation *****
  Num examples = 100
  Batch size = 3

  0%|          | 0/34 [00:00<?, ?it/s]
  9%|▉         | 3/34 [00:00<00:01, 17.46it/s]
 15%|█▍        | 5/34 [00:00<00:02, 13.32it/s]
 21%|██        | 7/34 [00:00<00:02, 12.58it/s]
 26%|██▋       | 9/34 [00:00<00:02, 12.00it/s]
 32%|███▏      | 11/34 [00:00<00:02, 11.48it/s]
 38%|███▊      | 13/34 [00:01<00:01, 11.53it/s]
 44%|████▍     | 15/34 [00:01<00:01, 11.24it/s]
 50%|█████     | 17/34 [00:01<00:01, 11.36it/s]
 56%|█████▌    | 19/34 [00:01<00:01, 11.14it/s]
 62%|██████▏   | 21/34 [00:01<00:01, 11.29it/s]
 68%|██████▊   | 23/34 [00:01<00:01, 10.96it/s]
 74%|███████▎  | 25/34 [00:02<00:00, 11.14it/s]
 79%|███████▉  | 27/34 [00:02<00:00, 10.99it/s]
 85%|████████▌ | 29/34 [00:02<00:00, 11.16it/s]
 91%|█████████ | 31/34 [00:02<00:00, 11.30it/s]
 97%|█████████▋| 33/34 [00:02<00:00, 11.10it/s]{'TP': 3067, 'FP': 299, 'FN': 161, 'TN': 26766}
              precision    recall  f1-score   support

         LOC       0.85      0.84      0.85       279
         ORG       0.89      0.91      0.90       786
      PESSOA       0.87      0.96      0.91       323

   micro avg       0.87      0.91      0.89      1388
   macro avg       0.87      0.90      0.89      1388
weighted avg       0.87      0.91      0.89      1388

C:\Users\aceite\anaconda3\envs\ner-noticias-mapa\lib\site-packages\sklearn\utils\validation.py:70: FutureWarning: Pass labels=['B-LOC', 'B-ORG', 'B-PESSOA', 'I-LOC', 'I-ORG', 'I-PESSOA', 'O'] as keyword args. From version 1.0 (renaming of 0.25) passing these as positional arguments will result in an error
  warnings.warn(f"Pass {args_msg} as keyword args. From version "
              precision    recall  f1-score   support

       B-LOC       0.88      0.86      0.87       277
       B-ORG       0.92      0.93      0.93       782
    B-PESSOA       0.89      0.98      0.93       322
       I-LOC       0.86      0.92      0.89       154
       I-ORG       0.93      0.93      0.93      1312
    I-PESSOA       0.92      0.99      0.95       434
           O       0.99      0.99      0.99     27012

    accuracy                           0.98     30293
   macro avg       0.91      0.94      0.93     30293
weighted avg       0.99      0.98      0.98     30293

f1 0.891166077738516 f1_masked 0.897116411534354
{'eval_loss': 0.08951156586408615, 'eval_accuracy_score': 0.9848149737563133, 'eval_precision': 0.8744798890429958, 'eval_recall': 0.9085014409221902, 'eval_f1': 0.891166077738516, 'eval_f1_masked': 0.897116411534354, 'eval_runtime': 4.8775, 'eval_samples_per_second': 20.502, 'epoch': 11.0}
                                                   
 37%|███▋      | 1474/4020 [12:34<17:25,  2.44it/s]
100%|██████████| 34/34 [00:04<00:00, 11.10it/s]
                                               Saving model checkpoint to ./results\checkpoint-1474
Configuration saved in ./results\checkpoint-1474\config.json
Model weights saved in ./results\checkpoint-1474\pytorch_model.bin
 37%|███▋      | 1480/4020 [12:41<37:09,  1.14it/s]{'loss': 0.0021, 'learning_rate': 3.6079545454545454e-05, 'epoch': 11.04}
 37%|███▋      | 1490/4020 [12:45<19:08,  2.20it/s]{'loss': 0.0027, 'learning_rate': 3.59375e-05, 'epoch': 11.12}
 37%|███▋      | 1500/4020 [12:50<18:33,  2.26it/s]{'loss': 0.0186, 'learning_rate': 3.579545454545455e-05, 'epoch': 11.19}
 38%|███▊      | 1510/4020 [12:54<18:31,  2.26it/s]{'loss': 0.0055, 'learning_rate': 3.565340909090909e-05, 'epoch': 11.27}
 38%|███▊      | 1520/4020 [12:59<18:20,  2.27it/s]{'loss': 0.0018, 'learning_rate': 3.5511363636363635e-05, 'epoch': 11.34}
 38%|███▊      | 1530/4020 [13:03<18:18,  2.27it/s]{'loss': 0.0047, 'learning_rate': 3.5369318181818186e-05, 'epoch': 11.42}
 38%|███▊      | 1540/4020 [13:07<18:09,  2.28it/s]{'loss': 0.0053, 'learning_rate': 3.522727272727273e-05, 'epoch': 11.49}
 39%|███▊      | 1550/4020 [13:12<18:18,  2.25it/s]{'loss': 0.0054, 'learning_rate': 3.508522727272727e-05, 'epoch': 11.57}
 39%|███▉      | 1560/4020 [13:16<17:56,  2.29it/s]{'loss': 0.0088, 'learning_rate': 3.494318181818182e-05, 'epoch': 11.64}
 39%|███▉      | 1570/4020 [13:21<17:59,  2.27it/s]{'loss': 0.0308, 'learning_rate': 3.480113636363637e-05, 'epoch': 11.72}
 39%|███▉      | 1580/4020 [13:25<17:45,  2.29it/s]{'loss': 0.0041, 'learning_rate': 3.465909090909091e-05, 'epoch': 11.79}
 40%|███▉      | 1590/4020 [13:29<17:56,  2.26it/s]{'loss': 0.006, 'learning_rate': 3.451704545454546e-05, 'epoch': 11.87}
 40%|███▉      | 1600/4020 [13:34<17:37,  2.29it/s]{'loss': 0.022, 'learning_rate': 3.4375e-05, 'epoch': 11.94}
 40%|████      | 1608/4020 [13:37<16:26,  2.44it/s]***** Running Evaluation *****
  Num examples = 100
  Batch size = 3

  0%|          | 0/34 [00:00<?, ?it/s]
  9%|▉         | 3/34 [00:00<00:01, 17.46it/s]
 15%|█▍        | 5/34 [00:00<00:02, 13.32it/s]
 21%|██        | 7/34 [00:00<00:02, 12.58it/s]
 26%|██▋       | 9/34 [00:00<00:02, 11.80it/s]
 32%|███▏      | 11/34 [00:00<00:01, 11.74it/s]
 38%|███▊      | 13/34 [00:01<00:01, 11.53it/s]
 44%|████▍     | 15/34 [00:01<00:01, 11.22it/s]
 50%|█████     | 17/34 [00:01<00:01, 11.35it/s]
 56%|█████▌    | 19/34 [00:01<00:01, 11.13it/s]
 62%|██████▏   | 21/34 [00:01<00:01, 11.28it/s]
 68%|██████▊   | 23/34 [00:01<00:00, 11.24it/s]
 74%|███████▎  | 25/34 [00:02<00:00, 11.04it/s]
 79%|███████▉  | 27/34 [00:02<00:00, 11.21it/s]
 85%|████████▌ | 29/34 [00:02<00:00, 11.19it/s]
 91%|█████████ | 31/34 [00:02<00:00, 11.01it/s]
 97%|█████████▋| 33/34 [00:02<00:00, 11.19it/s]{'TP': 3082, 'FP': 363, 'FN': 137, 'TN': 26711}
C:\Users\aceite\anaconda3\envs\ner-noticias-mapa\lib\site-packages\sklearn\utils\validation.py:70: FutureWarning: Pass labels=['B-LOC', 'B-ORG', 'B-PESSOA', 'I-LOC', 'I-ORG', 'I-PESSOA', 'O'] as keyword args. From version 1.0 (renaming of 0.25) passing these as positional arguments will result in an error
  warnings.warn(f"Pass {args_msg} as keyword args. From version "
              precision    recall  f1-score   support

         LOC       0.83      0.86      0.85       279
         ORG       0.84      0.90      0.87       786
      PESSOA       0.87      0.96      0.91       323

   micro avg       0.85      0.91      0.88      1388
   macro avg       0.85      0.91      0.88      1388
weighted avg       0.85      0.91      0.88      1388

              precision    recall  f1-score   support

       B-LOC       0.85      0.87      0.86       277
       B-ORG       0.91      0.94      0.92       782
    B-PESSOA       0.91      0.97      0.94       322
       I-LOC       0.86      0.90      0.88       154
       I-ORG       0.89      0.94      0.91      1312
    I-PESSOA       0.92      0.98      0.95       434
           O       0.99      0.99      0.99     27012

    accuracy                           0.98     30293
   macro avg       0.90      0.94      0.92     30293
weighted avg       0.98      0.98      0.98     30293

f1 0.875217240180744 f1_masked 0.8925795053003535
                                                   
 40%|████      | 1608/4020 [13:42<16:26,  2.44it/s]
100%|██████████| 34/34 [00:04<00:00, 11.19it/s]
                                               Saving model checkpoint to ./results\checkpoint-1608
Configuration saved in ./results\checkpoint-1608\config.json
{'eval_loss': 0.08858099579811096, 'eval_accuracy_score': 0.9834945366916449, 'eval_precision': 0.8455339153794493, 'eval_recall': 0.9070605187319885, 'eval_f1': 0.875217240180744, 'eval_f1_masked': 0.8925795053003535, 'eval_runtime': 4.8639, 'eval_samples_per_second': 20.56, 'epoch': 12.0}
Model weights saved in ./results\checkpoint-1608\pytorch_model.bin
 40%|████      | 1610/4020 [13:47<1:32:37,  2.31s/it]{'loss': 0.0099, 'learning_rate': 3.423295454545455e-05, 'epoch': 12.01}
 40%|████      | 1620/4020 [13:51<19:34,  2.04it/s]{'loss': 0.0064, 'learning_rate': 3.409090909090909e-05, 'epoch': 12.09}
 41%|████      | 1630/4020 [13:56<17:37,  2.26it/s]{'loss': 0.0338, 'learning_rate': 3.394886363636364e-05, 'epoch': 12.16}
 41%|████      | 1640/4020 [14:00<17:27,  2.27it/s]{'loss': 0.0031, 'learning_rate': 3.380681818181818e-05, 'epoch': 12.24}
 41%|████      | 1650/4020 [14:05<17:23,  2.27it/s]{'loss': 0.0026, 'learning_rate': 3.3664772727272734e-05, 'epoch': 12.31}
 41%|████▏     | 1660/4020 [14:09<17:30,  2.25it/s]{'loss': 0.0042, 'learning_rate': 3.352272727272727e-05, 'epoch': 12.39}
 42%|████▏     | 1670/4020 [14:14<17:18,  2.26it/s]{'loss': 0.0029, 'learning_rate': 3.338068181818182e-05, 'epoch': 12.46}
 42%|████▏     | 1680/4020 [14:18<17:12,  2.27it/s]{'loss': 0.002, 'learning_rate': 3.323863636363637e-05, 'epoch': 12.54}
 42%|████▏     | 1690/4020 [14:23<17:15,  2.25it/s]{'loss': 0.0021, 'learning_rate': 3.3096590909090915e-05, 'epoch': 12.61}
 42%|████▏     | 1700/4020 [14:27<17:50,  2.17it/s]{'loss': 0.005, 'learning_rate': 3.295454545454545e-05, 'epoch': 12.69}
 43%|████▎     | 1710/4020 [14:32<17:24,  2.21it/s]{'loss': 0.0032, 'learning_rate': 3.2812500000000005e-05, 'epoch': 12.76}
 43%|████▎     | 1720/4020 [14:36<17:05,  2.24it/s]{'loss': 0.0273, 'learning_rate': 3.267045454545455e-05, 'epoch': 12.84}
 43%|████▎     | 1730/4020 [14:41<16:52,  2.26it/s]{'loss': 0.0021, 'learning_rate': 3.252840909090909e-05, 'epoch': 12.91}
 43%|████▎     | 1740/4020 [14:45<16:47,  2.26it/s]{'loss': 0.0019, 'learning_rate': 3.238636363636364e-05, 'epoch': 12.99}
 43%|████▎     | 1742/4020 [14:46<15:41,  2.42it/s]***** Running Evaluation *****
  Num examples = 100
  Batch size = 3

  0%|          | 0/34 [00:00<?, ?it/s]
  9%|▉         | 3/34 [00:00<00:01, 16.00it/s]
 15%|█▍        | 5/34 [00:00<00:02, 13.53it/s]
 21%|██        | 7/34 [00:00<00:02, 12.19it/s]
 26%|██▋       | 9/34 [00:00<00:02, 11.76it/s]
 32%|███▏      | 11/34 [00:00<00:01, 11.69it/s]
 38%|███▊      | 13/34 [00:01<00:01, 11.33it/s]
 44%|████▍     | 15/34 [00:01<00:01, 11.11it/s]
 50%|█████     | 17/34 [00:01<00:01, 11.10it/s]
 56%|█████▌    | 19/34 [00:01<00:01, 11.24it/s]
 62%|██████▏   | 21/34 [00:01<00:01, 11.06it/s]
 68%|██████▊   | 23/34 [00:01<00:00, 11.23it/s]
 74%|███████▎  | 25/34 [00:02<00:00, 11.19it/s]
 79%|███████▉  | 27/34 [00:02<00:00, 11.01it/s]
 85%|████████▌ | 29/34 [00:02<00:00, 11.19it/s]
 91%|█████████ | 31/34 [00:02<00:00, 11.03it/s]
 97%|█████████▋| 33/34 [00:02<00:00, 10.92it/s]{'TP': 3097, 'FP': 350, 'FN': 117, 'TN': 26729}
              precision    recall  f1-score   support

         LOC       0.85      0.91      0.88       279
         ORG       0.86      0.90      0.88       786
      PESSOA       0.86      0.96      0.91       323

   micro avg       0.86      0.92      0.89      1388
   macro avg       0.86      0.93      0.89      1388
weighted avg       0.86      0.92      0.89      1388

C:\Users\aceite\anaconda3\envs\ner-noticias-mapa\lib\site-packages\sklearn\utils\validation.py:70: FutureWarning: Pass labels=['B-LOC', 'B-ORG', 'B-PESSOA', 'I-LOC', 'I-ORG', 'I-PESSOA', 'O'] as keyword args. From version 1.0 (renaming of 0.25) passing these as positional arguments will result in an error
  warnings.warn(f"Pass {args_msg} as keyword args. From version "
              precision    recall  f1-score   support

       B-LOC       0.87      0.92      0.89       277
       B-ORG       0.91      0.92      0.92       782
    B-PESSOA       0.88      0.98      0.93       322
       I-LOC       0.86      0.92      0.89       154
       I-ORG       0.90      0.94      0.92      1312
    I-PESSOA       0.90      0.98      0.94       434
           O       1.00      0.99      0.99     27012

    accuracy                           0.98     30293
   macro avg       0.90      0.95      0.93     30293
weighted avg       0.99      0.98      0.98     30293

f1 0.8875739644970414 f1_masked 0.8967946460021134
                                                   
 43%|████▎     | 1742/4020 [14:51<15:41,  2.42it/s]
100%|██████████| 34/34 [00:04<00:00, 10.92it/s]
                                               Saving model checkpoint to ./results\checkpoint-1742
Configuration saved in ./results\checkpoint-1742\config.json
{'eval_loss': 0.0967780128121376, 'eval_accuracy_score': 0.9845838972699964, 'eval_precision': 0.8585858585858586, 'eval_recall': 0.9185878962536023, 'eval_f1': 0.8875739644970414, 'eval_f1_masked': 0.8967946460021134, 'eval_runtime': 4.8896, 'eval_samples_per_second': 20.452, 'epoch': 13.0}
Model weights saved in ./results\checkpoint-1742\pytorch_model.bin
 44%|████▎     | 1750/4020 [14:58<25:35,  1.48it/s]{'loss': 0.0048, 'learning_rate': 3.2244318181818185e-05, 'epoch': 13.06}
 44%|████▍     | 1760/4020 [15:03<16:44,  2.25it/s]{'loss': 0.002, 'learning_rate': 3.210227272727273e-05, 'epoch': 13.13}
 44%|████▍     | 1770/4020 [15:07<16:35,  2.26it/s]{'loss': 0.0015, 'learning_rate': 3.1960227272727275e-05, 'epoch': 13.21}
 44%|████▍     | 1780/4020 [15:12<16:24,  2.28it/s]{'loss': 0.0411, 'learning_rate': 3.181818181818182e-05, 'epoch': 13.28}
 45%|████▍     | 1790/4020 [15:16<16:35,  2.24it/s]{'loss': 0.0114, 'learning_rate': 3.1676136363636365e-05, 'epoch': 13.36}
 45%|████▍     | 1800/4020 [15:21<16:44,  2.21it/s]{'loss': 0.0032, 'learning_rate': 3.153409090909091e-05, 'epoch': 13.43}
 45%|████▌     | 1810/4020 [15:25<16:30,  2.23it/s]{'loss': 0.0019, 'learning_rate': 3.1392045454545456e-05, 'epoch': 13.51}
 45%|████▌     | 1820/4020 [15:30<16:58,  2.16it/s]{'loss': 0.0035, 'learning_rate': 3.125e-05, 'epoch': 13.58}
 46%|████▌     | 1830/4020 [15:34<16:45,  2.18it/s]{'loss': 0.0048, 'learning_rate': 3.1107954545454546e-05, 'epoch': 13.66}
 46%|████▌     | 1840/4020 [15:39<16:12,  2.24it/s]{'loss': 0.0018, 'learning_rate': 3.096590909090909e-05, 'epoch': 13.73}
 46%|████▌     | 1850/4020 [15:43<16:13,  2.23it/s]{'loss': 0.0037, 'learning_rate': 3.0823863636363636e-05, 'epoch': 13.81}
 46%|████▋     | 1860/4020 [15:48<16:10,  2.23it/s]{'loss': 0.0013, 'learning_rate': 3.068181818181818e-05, 'epoch': 13.88}
 47%|████▋     | 1870/4020 [15:52<16:32,  2.17it/s]{'loss': 0.0168, 'learning_rate': 3.053977272727273e-05, 'epoch': 13.96}
 47%|████▋     | 1876/4020 [15:55<15:18,  2.34it/s]***** Running Evaluation *****
  Num examples = 100
  Batch size = 3

  0%|          | 0/34 [00:00<?, ?it/s]
  9%|▉         | 3/34 [00:00<00:01, 16.08it/s]
 15%|█▍        | 5/34 [00:00<00:02, 13.64it/s]
 21%|██        | 7/34 [00:00<00:02, 12.24it/s]
 26%|██▋       | 9/34 [00:00<00:02, 11.61it/s]
 32%|███▏      | 11/34 [00:00<00:01, 11.61it/s]
 38%|███▊      | 13/34 [00:01<00:01, 11.28it/s]
 44%|████▍     | 15/34 [00:01<00:01, 10.78it/s]
 50%|█████     | 17/34 [00:01<00:01, 11.04it/s]
 56%|█████▌    | 19/34 [00:01<00:01, 10.92it/s]
 62%|██████▏   | 21/34 [00:01<00:01, 10.82it/s]
 68%|██████▊   | 23/34 [00:02<00:01, 10.79it/s]
 74%|███████▎  | 25/34 [00:02<00:00, 11.04it/s]
 79%|███████▉  | 27/34 [00:02<00:00, 10.92it/s]
 85%|████████▌ | 29/34 [00:02<00:00, 10.84it/s]
 91%|█████████ | 31/34 [00:02<00:00, 10.78it/s]
 97%|█████████▋| 33/34 [00:02<00:00, 10.72it/s]{'TP': 3084, 'FP': 340, 'FN': 139, 'TN': 26730}
              precision    recall  f1-score   support

         LOC       0.84      0.87      0.85       279
         ORG       0.85      0.91      0.88       786
      PESSOA       0.87      0.97      0.92       323

   micro avg       0.85      0.91      0.88      1388
   macro avg       0.85      0.91      0.88      1388
weighted avg       0.85      0.91      0.88      1388

C:\Users\aceite\anaconda3\envs\ner-noticias-mapa\lib\site-packages\sklearn\utils\validation.py:70: FutureWarning: Pass labels=['B-LOC', 'B-ORG', 'B-PESSOA', 'I-LOC', 'I-ORG', 'I-PESSOA', 'O'] as keyword args. From version 1.0 (renaming of 0.25) passing these as positional arguments will result in an error
  warnings.warn(f"Pass {args_msg} as keyword args. From version "
              precision    recall  f1-score   support

       B-LOC       0.87      0.88      0.88       277
       B-ORG       0.90      0.95      0.92       782
    B-PESSOA       0.90      0.98      0.94       322
       I-LOC       0.86      0.92      0.89       154
       I-ORG       0.91      0.93      0.92      1312
    I-PESSOA       0.91      0.99      0.95       434
           O       0.99      0.99      0.99     27012

    accuracy                           0.98     30293
   macro avg       0.91      0.95      0.93     30293
weighted avg       0.98      0.98      0.98     30293

f1 0.881862404447533 f1_masked 0.8899018232819074
{'eval_loss': 0.09911718964576721, 'eval_accuracy_score': 0.9841877661505959, 'eval_precision': 0.8516778523489933, 'eval_recall': 0.9142651296829971, 'eval_f1': 0.881862404447533, 'eval_f1_masked': 0.8899018232819074, 'eval_runtime': 4.9516, 'eval_samples_per_second': 20.195, 'epoch': 14.0}
                                                   
 47%|████▋     | 1876/4020 [16:00<15:18,  2.34it/s]
100%|██████████| 34/34 [00:04<00:00, 10.72it/s]
                                               Saving model checkpoint to ./results\checkpoint-1876
Configuration saved in ./results\checkpoint-1876\config.json
Model weights saved in ./results\checkpoint-1876\pytorch_model.bin
 47%|████▋     | 1880/4020 [16:06<49:57,  1.40s/it]{'loss': 0.0011, 'learning_rate': 3.039772727272727e-05, 'epoch': 14.03}
 47%|████▋     | 1890/4020 [16:11<17:13,  2.06it/s]{'loss': 0.0052, 'learning_rate': 3.025568181818182e-05, 'epoch': 14.1}
 47%|████▋     | 1900/4020 [16:15<16:08,  2.19it/s]{'loss': 0.0012, 'learning_rate': 3.0113636363636365e-05, 'epoch': 14.18}
 48%|████▊     | 1910/4020 [16:20<16:09,  2.18it/s]{'loss': 0.0026, 'learning_rate': 2.9971590909090913e-05, 'epoch': 14.25}
 48%|████▊     | 1920/4020 [16:24<15:54,  2.20it/s]{'loss': 0.0032, 'learning_rate': 2.9829545454545455e-05, 'epoch': 14.33}
 48%|████▊     | 1930/4020 [16:29<15:33,  2.24it/s]{'loss': 0.0002, 'learning_rate': 2.96875e-05, 'epoch': 14.4}
 48%|████▊     | 1940/4020 [16:33<15:09,  2.29it/s]{'loss': 0.0028, 'learning_rate': 2.954545454545455e-05, 'epoch': 14.48}
 49%|████▊     | 1950/4020 [16:38<15:09,  2.28it/s]{'loss': 0.0013, 'learning_rate': 2.940340909090909e-05, 'epoch': 14.55}
 49%|████▉     | 1960/4020 [16:42<15:00,  2.29it/s]{'loss': 0.0013, 'learning_rate': 2.9261363636363635e-05, 'epoch': 14.63}
 49%|████▉     | 1970/4020 [16:46<15:04,  2.27it/s]{'loss': 0.0318, 'learning_rate': 2.9119318181818184e-05, 'epoch': 14.7}
 49%|████▉     | 1980/4020 [16:51<14:57,  2.27it/s]{'loss': 0.0015, 'learning_rate': 2.8977272727272732e-05, 'epoch': 14.78}
 50%|████▉     | 1990/4020 [16:55<14:41,  2.30it/s]{'loss': 0.0013, 'learning_rate': 2.883522727272727e-05, 'epoch': 14.85}
 50%|████▉     | 2000/4020 [17:00<15:01,  2.24it/s]{'loss': 0.0047, 'learning_rate': 2.869318181818182e-05, 'epoch': 14.93}
 50%|█████     | 2010/4020 [17:04<13:40,  2.45it/s]***** Running Evaluation *****
  Num examples = 100
  Batch size = 3
{'loss': 0.1494, 'learning_rate': 2.8551136363636367e-05, 'epoch': 15.0}

  0%|          | 0/34 [00:00<?, ?it/s]
  9%|▉         | 3/34 [00:00<00:01, 16.71it/s]
 15%|█▍        | 5/34 [00:00<00:02, 13.09it/s]
 21%|██        | 7/34 [00:00<00:02, 12.42it/s]
 26%|██▋       | 9/34 [00:00<00:02, 12.12it/s]
 32%|███▏      | 11/34 [00:00<00:01, 11.57it/s]
 38%|███▊      | 13/34 [00:01<00:01, 11.60it/s]
 44%|████▍     | 15/34 [00:01<00:01, 11.28it/s]
 50%|█████     | 17/34 [00:01<00:01, 11.39it/s]
 56%|█████▌    | 19/34 [00:01<00:01, 11.31it/s]
 62%|██████▏   | 21/34 [00:01<00:01, 11.09it/s]
 68%|██████▊   | 23/34 [00:01<00:00, 11.25it/s]
 74%|███████▎  | 25/34 [00:02<00:00, 11.07it/s]
 79%|███████▉  | 27/34 [00:02<00:00, 11.23it/s]
 85%|████████▌ | 29/34 [00:02<00:00, 11.06it/s]
 91%|█████████ | 31/34 [00:02<00:00, 11.23it/s]
 97%|█████████▋| 33/34 [00:02<00:00, 11.35it/s]{'TP': 3102, 'FP': 394, 'FN': 111, 'TN': 26686}
              precision    recall  f1-score   support

         LOC       0.84      0.90      0.87       279
         ORG       0.83      0.92      0.87       786
      PESSOA       0.88      0.98      0.92       323

   micro avg       0.84      0.93      0.88      1388
   macro avg       0.85      0.93      0.89      1388
weighted avg       0.84      0.93      0.88      1388

C:\Users\aceite\anaconda3\envs\ner-noticias-mapa\lib\site-packages\sklearn\utils\validation.py:70: FutureWarning: Pass labels=['B-LOC', 'B-ORG', 'B-PESSOA', 'I-LOC', 'I-ORG', 'I-PESSOA', 'O'] as keyword args. From version 1.0 (renaming of 0.25) passing these as positional arguments will result in an error
  warnings.warn(f"Pass {args_msg} as keyword args. From version "
              precision    recall  f1-score   support

       B-LOC       0.86      0.92      0.89       277
       B-ORG       0.88      0.95      0.91       782
    B-PESSOA       0.89      0.99      0.94       322
       I-LOC       0.86      0.88      0.87       154
       I-ORG       0.89      0.93      0.91      1312
    I-PESSOA       0.92      0.98      0.95       434
           O       1.00      0.99      0.99     27012

    accuracy                           0.98     30293
   macro avg       0.90      0.95      0.92     30293
weighted avg       0.98      0.98      0.98     30293

f1 0.8838487972508592 f1_masked 0.8919667590027701
                                                   
 50%|█████     | 2010/4020 [17:09<13:40,  2.45it/s]
100%|██████████| 34/34 [00:04<00:00, 11.35it/s]
                                               Saving model checkpoint to ./results\checkpoint-2010
Configuration saved in ./results\checkpoint-2010\config.json
{'eval_loss': 0.11536499112844467, 'eval_accuracy_score': 0.9833294820585614, 'eval_precision': 0.8449408672798949, 'eval_recall': 0.9265129682997119, 'eval_f1': 0.8838487972508592, 'eval_f1_masked': 0.8919667590027701, 'eval_runtime': 4.8629, 'eval_samples_per_second': 20.564, 'epoch': 15.0}
Model weights saved in ./results\checkpoint-2010\pytorch_model.bin
 50%|█████     | 2020/4020 [17:17<18:07,  1.84it/s]{'loss': 0.0781, 'learning_rate': 2.8409090909090912e-05, 'epoch': 15.07}
 50%|█████     | 2030/4020 [17:22<14:40,  2.26it/s]{'loss': 0.0029, 'learning_rate': 2.8267045454545454e-05, 'epoch': 15.15}
 51%|█████     | 2040/4020 [17:26<14:35,  2.26it/s]{'loss': 0.0254, 'learning_rate': 2.8125000000000003e-05, 'epoch': 15.22}
 51%|█████     | 2050/4020 [17:31<14:29,  2.27it/s]{'loss': 0.0046, 'learning_rate': 2.7982954545454548e-05, 'epoch': 15.3}
 51%|█████     | 2060/4020 [17:35<14:22,  2.27it/s]{'loss': 0.0011, 'learning_rate': 2.784090909090909e-05, 'epoch': 15.37}
 51%|█████▏    | 2070/4020 [17:39<14:26,  2.25it/s]{'loss': 0.0003, 'learning_rate': 2.7698863636363638e-05, 'epoch': 15.45}
 52%|█████▏    | 2080/4020 [17:44<14:51,  2.18it/s]{'loss': 0.0031, 'learning_rate': 2.7556818181818183e-05, 'epoch': 15.52}
 52%|█████▏    | 2090/4020 [17:48<14:12,  2.26it/s]{'loss': 0.0017, 'learning_rate': 2.741477272727273e-05, 'epoch': 15.6}
 52%|█████▏    | 2100/4020 [17:53<14:14,  2.25it/s]{'loss': 0.0036, 'learning_rate': 2.7272727272727273e-05, 'epoch': 15.67}
 52%|█████▏    | 2110/4020 [17:57<13:59,  2.28it/s]{'loss': 0.001, 'learning_rate': 2.7130681818181818e-05, 'epoch': 15.75}
 53%|█████▎    | 2120/4020 [18:02<14:03,  2.25it/s]{'loss': 0.0037, 'learning_rate': 2.6988636363636367e-05, 'epoch': 15.82}
 53%|█████▎    | 2130/4020 [18:06<13:47,  2.28it/s]{'loss': 0.0021, 'learning_rate': 2.6846590909090912e-05, 'epoch': 15.9}
 53%|█████▎    | 2140/4020 [18:10<13:41,  2.29it/s]{'loss': 0.0004, 'learning_rate': 2.6704545454545453e-05, 'epoch': 15.97}
 53%|█████▎    | 2144/4020 [18:12<12:51,  2.43it/s]***** Running Evaluation *****
  Num examples = 100
  Batch size = 3

  0%|          | 0/34 [00:00<?, ?it/s]
  9%|▉         | 3/34 [00:00<00:01, 16.00it/s]
 15%|█▍        | 5/34 [00:00<00:02, 13.18it/s]
 21%|██        | 7/34 [00:00<00:02, 12.47it/s]
 26%|██▋       | 9/34 [00:00<00:02, 11.45it/s]
 32%|███▏      | 11/34 [00:00<00:02, 11.14it/s]
 38%|███▊      | 13/34 [00:01<00:01, 11.13it/s]
 44%|████▍     | 15/34 [00:01<00:01, 11.13it/s]
 50%|█████     | 17/34 [00:01<00:01, 11.26it/s]
 56%|█████▌    | 19/34 [00:01<00:01, 11.22it/s]
 62%|██████▏   | 21/34 [00:01<00:01, 11.33it/s]
 68%|██████▊   | 23/34 [00:02<00:00, 11.12it/s]
 74%|███████▎  | 25/34 [00:02<00:00, 11.27it/s]
 79%|███████▉  | 27/34 [00:02<00:00, 11.08it/s]
 85%|████████▌ | 29/34 [00:02<00:00, 11.24it/s]
 91%|█████████ | 31/34 [00:02<00:00, 11.06it/s]
 97%|█████████▋| 33/34 [00:02<00:00, 11.23it/s]{'TP': 3100, 'FP': 342, 'FN': 117, 'TN': 26734}
              precision    recall  f1-score   support

         LOC       0.83      0.92      0.87       279
         ORG       0.87      0.91      0.89       786
      PESSOA       0.88      0.97      0.92       323

   micro avg       0.86      0.92      0.89      1388
   macro avg       0.86      0.93      0.89      1388
weighted avg       0.86      0.92      0.89      1388

C:\Users\aceite\anaconda3\envs\ner-noticias-mapa\lib\site-packages\sklearn\utils\validation.py:70: FutureWarning: Pass labels=['B-LOC', 'B-ORG', 'B-PESSOA', 'I-LOC', 'I-ORG', 'I-PESSOA', 'O'] as keyword args. From version 1.0 (renaming of 0.25) passing these as positional arguments will result in an error
  warnings.warn(f"Pass {args_msg} as keyword args. From version "
              precision    recall  f1-score   support

       B-LOC       0.85      0.93      0.89       277
       B-ORG       0.92      0.93      0.93       782
    B-PESSOA       0.89      0.98      0.93       322
       I-LOC       0.84      0.95      0.89       154
       I-ORG       0.91      0.93      0.92      1312
    I-PESSOA       0.92      0.99      0.95       434
           O       1.00      0.99      0.99     27012

    accuracy                           0.98     30293
   macro avg       0.90      0.96      0.93     30293
weighted avg       0.99      0.98      0.99     30293

f1 0.8930686172065483 f1_masked 0.9018642279282447
{'eval_loss': 0.10688100755214691, 'eval_accuracy_score': 0.98484798468293, 'eval_precision': 0.8644639244774106, 'eval_recall': 0.9236311239193083, 'eval_f1': 0.8930686172065483, 'eval_f1_masked': 0.9018642279282447, 'eval_runtime': 4.8777, 'eval_samples_per_second': 20.501, 'epoch': 16.0}
                                                   
 53%|█████▎    | 2144/4020 [18:17<12:51,  2.43it/s]
100%|██████████| 34/34 [00:04<00:00, 11.23it/s]
                                               Saving model checkpoint to ./results\checkpoint-2144
Configuration saved in ./results\checkpoint-2144\config.json
Model weights saved in ./results\checkpoint-2144\pytorch_model.bin
 53%|█████▎    | 2150/4020 [18:24<27:38,  1.13it/s]{'loss': 0.0034, 'learning_rate': 2.6562500000000002e-05, 'epoch': 16.04}
 54%|█████▎    | 2160/4020 [18:28<14:15,  2.17it/s]{'loss': 0.0007, 'learning_rate': 2.6420454545454547e-05, 'epoch': 16.12}
 54%|█████▍    | 2170/4020 [18:33<13:29,  2.29it/s]{'loss': 0.0007, 'learning_rate': 2.627840909090909e-05, 'epoch': 16.19}
 54%|█████▍    | 2180/4020 [18:37<13:27,  2.28it/s]{'loss': 0.0067, 'learning_rate': 2.6136363636363637e-05, 'epoch': 16.27}
 54%|█████▍    | 2190/4020 [18:41<13:22,  2.28it/s]{'loss': 0.0002, 'learning_rate': 2.5994318181818182e-05, 'epoch': 16.34}
 55%|█████▍    | 2200/4020 [18:46<13:20,  2.27it/s]{'loss': 0.0033, 'learning_rate': 2.585227272727273e-05, 'epoch': 16.42}
 55%|█████▍    | 2210/4020 [18:50<13:20,  2.26it/s]{'loss': 0.0027, 'learning_rate': 2.5710227272727272e-05, 'epoch': 16.49}
 55%|█████▌    | 2220/4020 [18:55<13:11,  2.28it/s]{'loss': 0.0016, 'learning_rate': 2.5568181818181817e-05, 'epoch': 16.57}
 55%|█████▌    | 2230/4020 [18:59<13:21,  2.23it/s]{'loss': 0.002, 'learning_rate': 2.5426136363636366e-05, 'epoch': 16.64}
 56%|█████▌    | 2240/4020 [19:03<13:01,  2.28it/s]{'loss': 0.0015, 'learning_rate': 2.5284090909090914e-05, 'epoch': 16.72}
 56%|█████▌    | 2250/4020 [19:08<12:57,  2.28it/s]{'loss': 0.0317, 'learning_rate': 2.5142045454545453e-05, 'epoch': 16.79}
 56%|█████▌    | 2260/4020 [19:12<13:00,  2.26it/s]{'loss': 0.0026, 'learning_rate': 2.5e-05, 'epoch': 16.87}
 56%|█████▋    | 2270/4020 [19:17<12:52,  2.26it/s]{'loss': 0.0016, 'learning_rate': 2.4857954545454546e-05, 'epoch': 16.94}
 57%|█████▋    | 2278/4020 [19:20<11:57,  2.43it/s]***** Running Evaluation *****
  Num examples = 100
  Batch size = 3

  0%|          | 0/34 [00:00<?, ?it/s]
  9%|▉         | 3/34 [00:00<00:01, 17.46it/s]
 15%|█▍        | 5/34 [00:00<00:02, 13.32it/s]
 21%|██        | 7/34 [00:00<00:02, 12.30it/s]
 26%|██▋       | 9/34 [00:00<00:02, 12.02it/s]
 32%|███▏      | 11/34 [00:00<00:01, 11.52it/s]
 38%|███▊      | 13/34 [00:01<00:01, 11.56it/s]
 44%|████▍     | 15/34 [00:01<00:01, 11.26it/s]
 50%|█████     | 17/34 [00:01<00:01, 11.37it/s]
 56%|█████▌    | 19/34 [00:01<00:01, 11.15it/s]
 62%|██████▏   | 21/34 [00:01<00:01, 11.13it/s]
 68%|██████▊   | 23/34 [00:01<00:00, 11.26it/s]
 74%|███████▎  | 25/34 [00:02<00:00, 11.07it/s]
 79%|███████▉  | 27/34 [00:02<00:00, 11.24it/s]
 85%|████████▌ | 29/34 [00:02<00:00, 11.06it/s]
 91%|█████████ | 31/34 [00:02<00:00, 10.94it/s]
 97%|█████████▋| 33/34 [00:02<00:00, 11.14it/s]{'TP': 3092, 'FP': 337, 'FN': 129, 'TN': 26735}
              precision    recall  f1-score   support

         LOC       0.85      0.87      0.86       279
         ORG       0.85      0.90      0.88       786
      PESSOA       0.87      0.97      0.92       323

   micro avg       0.86      0.91      0.88      1388
   macro avg       0.86      0.91      0.89      1388
weighted avg       0.86      0.91      0.88      1388

C:\Users\aceite\anaconda3\envs\ner-noticias-mapa\lib\site-packages\sklearn\utils\validation.py:70: FutureWarning: Pass labels=['B-LOC', 'B-ORG', 'B-PESSOA', 'I-LOC', 'I-ORG', 'I-PESSOA', 'O'] as keyword args. From version 1.0 (renaming of 0.25) passing these as positional arguments will result in an error
  warnings.warn(f"Pass {args_msg} as keyword args. From version "
              precision    recall  f1-score   support

       B-LOC       0.89      0.90      0.89       277
       B-ORG       0.91      0.94      0.93       782
    B-PESSOA       0.89      0.98      0.93       322
       I-LOC       0.87      0.90      0.89       154
       I-ORG       0.90      0.94      0.92      1312
    I-PESSOA       0.92      0.98      0.95       434
           O       1.00      0.99      0.99     27012

    accuracy                           0.98     30293
   macro avg       0.91      0.95      0.93     30293
weighted avg       0.99      0.98      0.98     30293

f1 0.882845188284519 f1_masked 0.8952380952380953
                                                   
 57%|█████▋    | 2278/4020 [19:25<11:57,  2.43it/s]
100%|██████████| 34/34 [00:04<00:00, 11.14it/s]
                                               Saving model checkpoint to ./results\checkpoint-2278
{'eval_loss': 0.10718557238578796, 'eval_accuracy_score': 0.9846169081966131, 'eval_precision': 0.8554054054054054, 'eval_recall': 0.9121037463976945, 'eval_f1': 0.882845188284519, 'eval_f1_masked': 0.8952380952380953, 'eval_runtime': 4.8832, 'eval_samples_per_second': 20.478, 'epoch': 17.0}
Configuration saved in ./results\checkpoint-2278\config.json
Model weights saved in ./results\checkpoint-2278\pytorch_model.bin
 57%|█████▋    | 2280/4020 [19:30<1:06:19,  2.29s/it]{'loss': 0.019, 'learning_rate': 2.471590909090909e-05, 'epoch': 17.01}
 57%|█████▋    | 2290/4020 [19:34<14:19,  2.01it/s]{'loss': 0.0146, 'learning_rate': 2.4573863636363636e-05, 'epoch': 17.09}
 57%|█████▋    | 2300/4020 [19:39<12:37,  2.27it/s]{'loss': 0.0006, 'learning_rate': 2.4431818181818185e-05, 'epoch': 17.16}
 57%|█████▋    | 2310/4020 [19:43<12:41,  2.24it/s]{'loss': 0.0019, 'learning_rate': 2.4289772727272727e-05, 'epoch': 17.24}
 58%|█████▊    | 2320/4020 [19:47<12:35,  2.25it/s]{'loss': 0.0011, 'learning_rate': 2.4147727272727275e-05, 'epoch': 17.31}
 58%|█████▊    | 2330/4020 [19:52<12:29,  2.25it/s]{'loss': 0.0034, 'learning_rate': 2.400568181818182e-05, 'epoch': 17.39}
 58%|█████▊    | 2340/4020 [19:56<12:23,  2.26it/s]{'loss': 0.0027, 'learning_rate': 2.3863636363636365e-05, 'epoch': 17.46}
 58%|█████▊    | 2350/4020 [20:01<12:10,  2.29it/s]{'loss': 0.0015, 'learning_rate': 2.372159090909091e-05, 'epoch': 17.54}
 59%|█████▊    | 2360/4020 [20:05<12:08,  2.28it/s]{'loss': 0.0028, 'learning_rate': 2.3579545454545455e-05, 'epoch': 17.61}
 59%|█████▉    | 2370/4020 [20:09<12:01,  2.29it/s]{'loss': 0.0016, 'learning_rate': 2.34375e-05, 'epoch': 17.69}
 59%|█████▉    | 2380/4020 [20:14<12:07,  2.25it/s]{'loss': 0.002, 'learning_rate': 2.3295454545454546e-05, 'epoch': 17.76}
 59%|█████▉    | 2390/4020 [20:18<11:48,  2.30it/s]{'loss': 0.0026, 'learning_rate': 2.315340909090909e-05, 'epoch': 17.84}
 60%|█████▉    | 2400/4020 [20:23<11:49,  2.28it/s]{'loss': 0.0005, 'learning_rate': 2.3011363636363636e-05, 'epoch': 17.91}
 60%|█████▉    | 2410/4020 [20:27<11:47,  2.28it/s]{'loss': 0.0275, 'learning_rate': 2.2869318181818184e-05, 'epoch': 17.99}
 60%|██████    | 2412/4020 [20:28<10:54,  2.46it/s]***** Running Evaluation *****
  Num examples = 100
  Batch size = 3

  0%|          | 0/34 [00:00<?, ?it/s]
  9%|▉         | 3/34 [00:00<00:02, 15.21it/s]
 15%|█▍        | 5/34 [00:00<00:02, 12.30it/s]
 21%|██        | 7/34 [00:00<00:02, 11.57it/s]
 26%|██▋       | 9/34 [00:00<00:02, 11.22it/s]
 32%|███▏      | 11/34 [00:00<00:02, 10.86it/s]
 38%|███▊      | 13/34 [00:01<00:01, 10.77it/s]
 44%|████▍     | 15/34 [00:01<00:01, 10.74it/s]
 50%|█████     | 17/34 [00:01<00:01, 11.01it/s]
 56%|█████▌    | 19/34 [00:01<00:01, 10.90it/s]
 62%|██████▏   | 21/34 [00:01<00:01, 10.95it/s]
 68%|██████▊   | 23/34 [00:02<00:01, 10.87it/s]
 74%|███████▎  | 25/34 [00:02<00:00, 10.91it/s]
 79%|███████▉  | 27/34 [00:02<00:00, 10.82it/s]
 85%|████████▌ | 29/34 [00:02<00:00, 11.05it/s]
 91%|█████████ | 31/34 [00:02<00:00, 10.93it/s]
 97%|█████████▋| 33/34 [00:02<00:00, 11.14it/s]{'TP': 3105, 'FP': 329, 'FN': 117, 'TN': 26742}
              precision    recall  f1-score   support

         LOC       0.85      0.90      0.88       279
         ORG       0.86      0.91      0.88       786
      PESSOA       0.88      0.97      0.92       323

   micro avg       0.86      0.92      0.89      1388
   macro avg       0.86      0.93      0.89      1388
weighted avg       0.86      0.92      0.89      1388

C:\Users\aceite\anaconda3\envs\ner-noticias-mapa\lib\site-packages\sklearn\utils\validation.py:70: FutureWarning: Pass labels=['B-LOC', 'B-ORG', 'B-PESSOA', 'I-LOC', 'I-ORG', 'I-PESSOA', 'O'] as keyword args. From version 1.0 (renaming of 0.25) passing these as positional arguments will result in an error
  warnings.warn(f"Pass {args_msg} as keyword args. From version "
              precision    recall  f1-score   support

       B-LOC       0.88      0.92      0.90       277
       B-ORG       0.91      0.95      0.93       782
    B-PESSOA       0.90      0.98      0.94       322
       I-LOC       0.85      0.94      0.89       154
       I-ORG       0.91      0.93      0.92      1312
    I-PESSOA       0.91      0.98      0.95       434
           O       1.00      0.99      0.99     27012

    accuracy                           0.99     30293
   macro avg       0.91      0.95      0.93     30293
weighted avg       0.99      0.99      0.99     30293

f1 0.8901251738525731 f1_masked 0.9005971197752021
{'eval_loss': 0.09928148984909058, 'eval_accuracy_score': 0.9852771267289473, 'eval_precision': 0.8602150537634409, 'eval_recall': 0.9221902017291066, 'eval_f1': 0.8901251738525731, 'eval_f1_masked': 0.9005971197752021, 'eval_runtime': 5.006, 'eval_samples_per_second': 19.976, 'epoch': 18.0}
                                                   
 60%|██████    | 2412/4020 [20:33<10:54,  2.46it/s]
100%|██████████| 34/34 [00:04<00:00, 11.14it/s]
                                               Saving model checkpoint to ./results\checkpoint-2412
Configuration saved in ./results\checkpoint-2412\config.json
Model weights saved in ./results\checkpoint-2412\pytorch_model.bin
 60%|██████    | 2420/4020 [20:41<17:57,  1.48it/s]{'loss': 0.0023, 'learning_rate': 2.272727272727273e-05, 'epoch': 18.06}
 60%|██████    | 2430/4020 [20:45<11:48,  2.24it/s]{'loss': 0.0002, 'learning_rate': 2.2585227272727274e-05, 'epoch': 18.13}
 61%|██████    | 2440/4020 [20:50<11:55,  2.21it/s]{'loss': 0.0041, 'learning_rate': 2.244318181818182e-05, 'epoch': 18.21}
 61%|██████    | 2450/4020 [20:54<11:56,  2.19it/s]{'loss': 0.0011, 'learning_rate': 2.2301136363636365e-05, 'epoch': 18.28}
 61%|██████    | 2460/4020 [20:59<11:47,  2.21it/s]{'loss': 0.0128, 'learning_rate': 2.215909090909091e-05, 'epoch': 18.36}
 61%|██████▏   | 2470/4020 [21:03<11:30,  2.24it/s]{'loss': 0.0007, 'learning_rate': 2.2017045454545458e-05, 'epoch': 18.43}
 62%|██████▏   | 2480/4020 [21:08<11:52,  2.16it/s]{'loss': 0.0004, 'learning_rate': 2.1875e-05, 'epoch': 18.51}
 62%|██████▏   | 2490/4020 [21:13<11:33,  2.21it/s]{'loss': 0.0013, 'learning_rate': 2.1732954545454545e-05, 'epoch': 18.58}
 62%|██████▏   | 2500/4020 [21:17<11:35,  2.18it/s]{'loss': 0.0128, 'learning_rate': 2.1590909090909093e-05, 'epoch': 18.66}
 62%|██████▏   | 2510/4020 [21:22<11:34,  2.17it/s]{'loss': 0.0023, 'learning_rate': 2.1448863636363635e-05, 'epoch': 18.73}
 63%|██████▎   | 2520/4020 [21:26<11:05,  2.26it/s]{'loss': 0.0015, 'learning_rate': 2.1306818181818183e-05, 'epoch': 18.81}
 63%|██████▎   | 2530/4020 [21:31<11:02,  2.25it/s]{'loss': 0.0005, 'learning_rate': 2.116477272727273e-05, 'epoch': 18.88}
 63%|██████▎   | 2540/4020 [21:35<10:52,  2.27it/s]{'loss': 0.0012, 'learning_rate': 2.1022727272727274e-05, 'epoch': 18.96}
 63%|██████▎   | 2546/4020 [21:38<10:05,  2.44it/s]***** Running Evaluation *****
  Num examples = 100
  Batch size = 3

  0%|          | 0/34 [00:00<?, ?it/s]
  9%|▉         | 3/34 [00:00<00:01, 16.41it/s]
 15%|█▍        | 5/34 [00:00<00:02, 13.29it/s]
 21%|██        | 7/34 [00:00<00:02, 12.26it/s]
 26%|██▋       | 9/34 [00:00<00:02, 11.78it/s]
 32%|███▏      | 11/34 [00:00<00:01, 11.53it/s]
 38%|███▊      | 13/34 [00:01<00:01, 11.36it/s]
 44%|████▍     | 15/34 [00:01<00:01, 11.27it/s]
 50%|█████     | 17/34 [00:01<00:01, 11.43it/s]
 56%|█████▌    | 19/34 [00:01<00:01, 11.12it/s]
 62%|██████▏   | 21/34 [00:01<00:01, 11.36it/s]
 68%|██████▊   | 23/34 [00:01<00:00, 11.16it/s]
 74%|███████▎  | 25/34 [00:02<00:00, 11.26it/s]
 79%|███████▉  | 27/34 [00:02<00:00, 10.99it/s]
 85%|████████▌ | 29/34 [00:02<00:00, 11.30it/s]
 91%|█████████ | 31/34 [00:02<00:00, 11.00it/s]
 97%|█████████▋| 33/34 [00:02<00:00, 11.27it/s]{'TP': 3115, 'FP': 341, 'FN': 109, 'TN': 26728}
C:\Users\aceite\anaconda3\envs\ner-noticias-mapa\lib\site-packages\sklearn\utils\validation.py:70: FutureWarning: Pass labels=['B-LOC', 'B-ORG', 'B-PESSOA', 'I-LOC', 'I-ORG', 'I-PESSOA', 'O'] as keyword args. From version 1.0 (renaming of 0.25) passing these as positional arguments will result in an error
  warnings.warn(f"Pass {args_msg} as keyword args. From version "
              precision    recall  f1-score   support

         LOC       0.85      0.93      0.89       279
         ORG       0.86      0.92      0.89       786
      PESSOA       0.87      0.96      0.91       323

   micro avg       0.86      0.93      0.89      1388
   macro avg       0.86      0.94      0.90      1388
weighted avg       0.86      0.93      0.89      1388

              precision    recall  f1-score   support

       B-LOC       0.86      0.94      0.90       277
       B-ORG       0.91      0.95      0.93       782
    B-PESSOA       0.89      0.98      0.93       322
       I-LOC       0.85      0.95      0.90       154
       I-ORG       0.91      0.93      0.92      1312
    I-PESSOA       0.92      0.97      0.95       434
           O       1.00      0.99      0.99     27012

    accuracy                           0.99     30293
   macro avg       0.90      0.96      0.93     30293
weighted avg       0.99      0.99      0.99     30293

f1 0.8941908713692945 f1_masked 0.9014280738418671
{'eval_loss': 0.10414992272853851, 'eval_accuracy_score': 0.9851450830224805, 'eval_precision': 0.8597074468085106, 'eval_recall': 0.9315561959654178, 'eval_f1': 0.8941908713692945, 'eval_f1_masked': 0.9014280738418671, 'eval_runtime': 4.9019, 'eval_samples_per_second': 20.4, 'epoch': 19.0}
                                                   
 63%|██████▎   | 2546/4020 [21:42<10:05,  2.44it/s]
100%|██████████| 34/34 [00:04<00:00, 11.27it/s]
                                               Saving model checkpoint to ./results\checkpoint-2546
Configuration saved in ./results\checkpoint-2546\config.json
Model weights saved in ./results\checkpoint-2546\pytorch_model.bin
 63%|██████▎   | 2550/4020 [21:48<33:07,  1.35s/it]{'loss': 0.0226, 'learning_rate': 2.088068181818182e-05, 'epoch': 19.03}
 64%|██████▎   | 2560/4020 [21:53<11:19,  2.15it/s]{'loss': 0.0007, 'learning_rate': 2.0738636363636367e-05, 'epoch': 19.1}
 64%|██████▍   | 2570/4020 [21:57<10:47,  2.24it/s]{'loss': 0.0007, 'learning_rate': 2.059659090909091e-05, 'epoch': 19.18}
 64%|██████▍   | 2580/4020 [22:02<11:11,  2.14it/s]{'loss': 0.0002, 'learning_rate': 2.0454545454545457e-05, 'epoch': 19.25}
 64%|██████▍   | 2590/4020 [22:06<11:03,  2.15it/s]{'loss': 0.0009, 'learning_rate': 2.0312500000000002e-05, 'epoch': 19.33}
 65%|██████▍   | 2600/4020 [22:11<10:26,  2.27it/s]{'loss': 0.0004, 'learning_rate': 2.0170454545454544e-05, 'epoch': 19.4}
 65%|██████▍   | 2610/4020 [22:15<10:21,  2.27it/s]{'loss': 0.0009, 'learning_rate': 2.0028409090909093e-05, 'epoch': 19.48}
 65%|██████▌   | 2620/4020 [22:20<10:32,  2.21it/s]{'loss': 0.0006, 'learning_rate': 1.9886363636363638e-05, 'epoch': 19.55}
 65%|██████▌   | 2630/4020 [22:24<10:23,  2.23it/s]{'loss': 0.0014, 'learning_rate': 1.9744318181818183e-05, 'epoch': 19.63}
 66%|██████▌   | 2640/4020 [22:29<10:17,  2.24it/s]{'loss': 0.0197, 'learning_rate': 1.9602272727272728e-05, 'epoch': 19.7}
 66%|██████▌   | 2650/4020 [22:33<10:04,  2.27it/s]{'loss': 0.0004, 'learning_rate': 1.9460227272727273e-05, 'epoch': 19.78}
 66%|██████▌   | 2660/4020 [22:38<09:56,  2.28it/s]{'loss': 0.0008, 'learning_rate': 1.9318181818181818e-05, 'epoch': 19.85}
 66%|██████▋   | 2670/4020 [22:42<10:03,  2.24it/s]{'loss': 0.0002, 'learning_rate': 1.9176136363636366e-05, 'epoch': 19.93}
 67%|██████▋   | 2680/4020 [22:46<09:17,  2.41it/s]***** Running Evaluation *****
  Num examples = 100
  Batch size = 3
{'loss': 0.0015, 'learning_rate': 1.9034090909090908e-05, 'epoch': 20.0}

  0%|          | 0/34 [00:00<?, ?it/s]
  9%|▉         | 3/34 [00:00<00:01, 17.48it/s]
 15%|█▍        | 5/34 [00:00<00:02, 13.33it/s]
 21%|██        | 7/34 [00:00<00:02, 12.09it/s]
 26%|██▋       | 9/34 [00:00<00:02, 11.81it/s]
 32%|███▏      | 11/34 [00:00<00:02, 11.14it/s]
 38%|███▊      | 13/34 [00:01<00:01, 10.97it/s]
 44%|████▍     | 15/34 [00:01<00:01, 10.88it/s]
 50%|█████     | 17/34 [00:01<00:01, 10.26it/s]
 56%|█████▌    | 19/34 [00:01<00:01, 10.39it/s]
 62%|██████▏   | 21/34 [00:01<00:01, 10.47it/s]
 68%|██████▊   | 23/34 [00:02<00:01, 10.53it/s]
 74%|███████▎  | 25/34 [00:02<00:00, 10.57it/s]
 79%|███████▉  | 27/34 [00:02<00:00, 10.60it/s]
 85%|████████▌ | 29/34 [00:02<00:00, 10.89it/s]
 91%|█████████ | 31/34 [00:02<00:00, 10.82it/s]
 97%|█████████▋| 33/34 [00:02<00:00, 10.78it/s]{'TP': 3112, 'FP': 334, 'FN': 109, 'TN': 26738}
C:\Users\aceite\anaconda3\envs\ner-noticias-mapa\lib\site-packages\sklearn\utils\validation.py:70: FutureWarning: Pass labels=['B-LOC', 'B-ORG', 'B-PESSOA', 'I-LOC', 'I-ORG', 'I-PESSOA', 'O'] as keyword args. From version 1.0 (renaming of 0.25) passing these as positional arguments will result in an error
  warnings.warn(f"Pass {args_msg} as keyword args. From version "
              precision    recall  f1-score   support

         LOC       0.84      0.93      0.88       279
         ORG       0.87      0.91      0.89       786
      PESSOA       0.86      0.97      0.91       323

   micro avg       0.86      0.93      0.89      1388
   macro avg       0.86      0.94      0.89      1388
weighted avg       0.86      0.93      0.89      1388

              precision    recall  f1-score   support

       B-LOC       0.87      0.94      0.90       277
       B-ORG       0.92      0.95      0.93       782
    B-PESSOA       0.88      0.98      0.93       322
       I-LOC       0.87      0.92      0.90       154
       I-ORG       0.91      0.94      0.92      1312
    I-PESSOA       0.92      0.98      0.95       434
           O       1.00      0.99      0.99     27012

    accuracy                           0.99     30293
   macro avg       0.91      0.96      0.93     30293
weighted avg       0.99      0.99      0.99     30293

f1 0.8926592797783934 f1_masked 0.9034965034965035
                                                   
 67%|██████▋   | 2680/4020 [22:51<09:17,  2.41it/s]
100%|██████████| 34/34 [00:04<00:00, 10.78it/s]
                                               Saving model checkpoint to ./results\checkpoint-2680
Configuration saved in ./results\checkpoint-2680\config.json
{'eval_loss': 0.11476172506809235, 'eval_accuracy_score': 0.9853761595087974, 'eval_precision': 0.8593333333333333, 'eval_recall': 0.9286743515850144, 'eval_f1': 0.8926592797783934, 'eval_f1_masked': 0.9034965034965035, 'eval_runtime': 5.0478, 'eval_samples_per_second': 19.811, 'epoch': 20.0}
Model weights saved in ./results\checkpoint-2680\pytorch_model.bin
 67%|██████▋   | 2690/4020 [23:00<12:35,  1.76it/s]{'loss': 0.0007, 'learning_rate': 1.8892045454545457e-05, 'epoch': 20.07}
 67%|██████▋   | 2700/4020 [23:04<09:51,  2.23it/s]{'loss': 0.012, 'learning_rate': 1.8750000000000002e-05, 'epoch': 20.15}
 67%|██████▋   | 2710/4020 [23:09<09:49,  2.22it/s]{'loss': 0.0023, 'learning_rate': 1.8607954545454543e-05, 'epoch': 20.22}
 68%|██████▊   | 2720/4020 [23:13<10:03,  2.15it/s]{'loss': 0.0009, 'learning_rate': 1.8465909090909092e-05, 'epoch': 20.3}
 68%|██████▊   | 2730/4020 [23:18<10:07,  2.12it/s]{'loss': 0.0011, 'learning_rate': 1.8323863636363637e-05, 'epoch': 20.37}
 68%|██████▊   | 2740/4020 [23:23<09:44,  2.19it/s]{'loss': 0.0001, 'learning_rate': 1.8181818181818182e-05, 'epoch': 20.45}
 68%|██████▊   | 2750/4020 [23:27<09:27,  2.24it/s]{'loss': 0.0002, 'learning_rate': 1.8039772727272727e-05, 'epoch': 20.52}
 69%|██████▊   | 2760/4020 [23:32<09:40,  2.17it/s]{'loss': 0.0019, 'learning_rate': 1.7897727272727276e-05, 'epoch': 20.6}
 69%|██████▉   | 2770/4020 [23:36<09:33,  2.18it/s]{'loss': 0.0156, 'learning_rate': 1.7755681818181817e-05, 'epoch': 20.67}
 69%|██████▉   | 2780/4020 [23:41<09:06,  2.27it/s]{'loss': 0.0001, 'learning_rate': 1.7613636363636366e-05, 'epoch': 20.75}
 69%|██████▉   | 2790/4020 [23:45<08:55,  2.30it/s]{'loss': 0.0004, 'learning_rate': 1.747159090909091e-05, 'epoch': 20.82}
 70%|██████▉   | 2800/4020 [23:49<08:55,  2.28it/s]{'loss': 0.0012, 'learning_rate': 1.7329545454545456e-05, 'epoch': 20.9}
 70%|██████▉   | 2810/4020 [23:54<08:45,  2.30it/s]{'loss': 0.001, 'learning_rate': 1.71875e-05, 'epoch': 20.97}
 70%|███████   | 2814/4020 [23:55<08:09,  2.46it/s]***** Running Evaluation *****
  Num examples = 100
  Batch size = 3

  0%|          | 0/34 [00:00<?, ?it/s]
  9%|▉         | 3/34 [00:00<00:01, 16.97it/s]
 15%|█▍        | 5/34 [00:00<00:02, 13.17it/s]
 21%|██        | 7/34 [00:00<00:02, 12.49it/s]
 26%|██▋       | 9/34 [00:00<00:02, 11.75it/s]
 32%|███▏      | 11/34 [00:00<00:02, 11.35it/s]
 38%|███▊      | 13/34 [00:01<00:01, 11.45it/s]
 44%|████▍     | 15/34 [00:01<00:01, 11.18it/s]
 50%|█████     | 17/34 [00:01<00:01, 11.02it/s]
 56%|█████▌    | 19/34 [00:01<00:01, 11.20it/s]
 62%|██████▏   | 21/34 [00:01<00:01, 10.89it/s]
 68%|██████▊   | 23/34 [00:02<00:01, 10.96it/s]
 74%|███████▎  | 25/34 [00:02<00:00, 11.16it/s]
 79%|███████▉  | 27/34 [00:02<00:00, 11.01it/s]
 85%|████████▌ | 29/34 [00:02<00:00, 10.90it/s]
 91%|█████████ | 31/34 [00:02<00:00, 10.83it/s]
 97%|█████████▋| 33/34 [00:02<00:00, 11.06it/s]{'TP': 3118, 'FP': 342, 'FN': 102, 'TN': 26731}
C:\Users\aceite\anaconda3\envs\ner-noticias-mapa\lib\site-packages\sklearn\utils\validation.py:70: FutureWarning: Pass labels=['B-LOC', 'B-ORG', 'B-PESSOA', 'I-LOC', 'I-ORG', 'I-PESSOA', 'O'] as keyword args. From version 1.0 (renaming of 0.25) passing these as positional arguments will result in an error
  warnings.warn(f"Pass {args_msg} as keyword args. From version "
              precision    recall  f1-score   support

         LOC       0.85      0.94      0.89       279
         ORG       0.87      0.92      0.89       786
      PESSOA       0.85      0.96      0.90       323

   micro avg       0.86      0.93      0.90      1388
   macro avg       0.86      0.94      0.90      1388
weighted avg       0.86      0.93      0.90      1388

              precision    recall  f1-score   support

       B-LOC       0.87      0.94      0.90       277
       B-ORG       0.92      0.95      0.93       782
    B-PESSOA       0.88      0.98      0.93       322
       I-LOC       0.88      0.92      0.90       154
       I-ORG       0.90      0.94      0.92      1312
    I-PESSOA       0.91      0.98      0.95       434
           O       1.00      0.99      0.99     27012

    accuracy                           0.99     30293
   macro avg       0.91      0.96      0.93     30293
weighted avg       0.99      0.99      0.99     30293

f1 0.8958116995500173 f1_masked 0.905344044708348
                                                   
 70%|███████   | 2814/4020 [24:00<08:09,  2.46it/s]
100%|██████████| 34/34 [00:04<00:00, 11.06it/s]
                                               Saving model checkpoint to ./results\checkpoint-2814
Configuration saved in ./results\checkpoint-2814\config.json
{'eval_loss': 0.1181238442659378, 'eval_accuracy_score': 0.9853431485821808, 'eval_precision': 0.8620919387075283, 'eval_recall': 0.9322766570605188, 'eval_f1': 0.8958116995500173, 'eval_f1_masked': 0.905344044708348, 'eval_runtime': 4.8959, 'eval_samples_per_second': 20.425, 'epoch': 21.0}
Model weights saved in ./results\checkpoint-2814\pytorch_model.bin
 70%|███████   | 2820/4020 [24:07<17:40,  1.13it/s]{'loss': 0.0012, 'learning_rate': 1.7045454545454546e-05, 'epoch': 21.04}
 70%|███████   | 2830/4020 [24:11<08:51,  2.24it/s]{'loss': 0.0014, 'learning_rate': 1.690340909090909e-05, 'epoch': 21.12}
 71%|███████   | 2840/4020 [24:16<08:33,  2.30it/s]{'loss': 0.0009, 'learning_rate': 1.6761363636363636e-05, 'epoch': 21.19}
 71%|███████   | 2850/4020 [24:20<08:28,  2.30it/s]{'loss': 0.0, 'learning_rate': 1.6619318181818185e-05, 'epoch': 21.27}
 71%|███████   | 2860/4020 [24:24<08:23,  2.30it/s]{'loss': 0.0001, 'learning_rate': 1.6477272727272726e-05, 'epoch': 21.34}
 71%|███████▏  | 2870/4020 [24:29<08:40,  2.21it/s]{'loss': 0.0004, 'learning_rate': 1.6335227272727275e-05, 'epoch': 21.42}
 72%|███████▏  | 2880/4020 [24:33<08:23,  2.26it/s]{'loss': 0.0009, 'learning_rate': 1.619318181818182e-05, 'epoch': 21.49}
 72%|███████▏  | 2890/4020 [24:38<08:37,  2.18it/s]{'loss': 0.0007, 'learning_rate': 1.6051136363636365e-05, 'epoch': 21.57}
 72%|███████▏  | 2900/4020 [24:42<08:27,  2.21it/s]{'loss': 0.0007, 'learning_rate': 1.590909090909091e-05, 'epoch': 21.64}
 72%|███████▏  | 2910/4020 [24:47<08:14,  2.24it/s]{'loss': 0.001, 'learning_rate': 1.5767045454545455e-05, 'epoch': 21.72}
 73%|███████▎  | 2920/4020 [24:51<07:56,  2.31it/s]{'loss': 0.0151, 'learning_rate': 1.5625e-05, 'epoch': 21.79}
 73%|███████▎  | 2930/4020 [24:56<08:02,  2.26it/s]{'loss': 0.0001, 'learning_rate': 1.5482954545454545e-05, 'epoch': 21.87}
 73%|███████▎  | 2940/4020 [25:00<08:00,  2.25it/s]{'loss': 0.0183, 'learning_rate': 1.534090909090909e-05, 'epoch': 21.94}
 73%|███████▎  | 2948/4020 [25:04<07:22,  2.42it/s]***** Running Evaluation *****
  Num examples = 100
  Batch size = 3

  0%|          | 0/34 [00:00<?, ?it/s]
  9%|▉         | 3/34 [00:00<00:01, 15.97it/s]
 15%|█▍        | 5/34 [00:00<00:02, 12.86it/s]
 21%|██        | 7/34 [00:00<00:02, 11.85it/s]
 26%|██▋       | 9/34 [00:00<00:02, 11.39it/s]
 32%|███▏      | 11/34 [00:00<00:02, 11.13it/s]
 38%|███▊      | 13/34 [00:01<00:01, 10.97it/s]
 44%|████▍     | 15/34 [00:01<00:01, 10.87it/s]
 50%|█████     | 17/34 [00:01<00:01, 10.81it/s]
 56%|█████▌    | 19/34 [00:01<00:01, 11.05it/s]
 62%|██████▏   | 21/34 [00:01<00:01, 10.93it/s]
 68%|██████▊   | 23/34 [00:02<00:01, 10.85it/s]
 74%|███████▎  | 25/34 [00:02<00:00, 10.79it/s]
 79%|███████▉  | 27/34 [00:02<00:00, 10.75it/s]
 85%|████████▌ | 29/34 [00:02<00:00, 10.72it/s]
 91%|█████████ | 31/34 [00:02<00:00, 10.99it/s]
 97%|█████████▋| 33/34 [00:02<00:00, 10.89it/s]{'TP': 3108, 'FP': 345, 'FN': 113, 'TN': 26727}
              precision    recall  f1-score   support

         LOC       0.86      0.92      0.89       279
         ORG       0.86      0.91      0.89       786
      PESSOA       0.86      0.97      0.91       323

   micro avg       0.86      0.93      0.89      1388
   macro avg       0.86      0.94      0.90      1388
weighted avg       0.86      0.93      0.89      1388

C:\Users\aceite\anaconda3\envs\ner-noticias-mapa\lib\site-packages\sklearn\utils\validation.py:70: FutureWarning: Pass labels=['B-LOC', 'B-ORG', 'B-PESSOA', 'I-LOC', 'I-ORG', 'I-PESSOA', 'O'] as keyword args. From version 1.0 (renaming of 0.25) passing these as positional arguments will result in an error
  warnings.warn(f"Pass {args_msg} as keyword args. From version "
              precision    recall  f1-score   support

       B-LOC       0.87      0.93      0.90       277
       B-ORG       0.91      0.95      0.93       782
    B-PESSOA       0.88      0.98      0.93       322
       I-LOC       0.87      0.93      0.90       154
       I-ORG       0.90      0.93      0.92      1312
    I-PESSOA       0.92      0.98      0.95       434
           O       1.00      0.99      0.99     27012

    accuracy                           0.98     30293
   macro avg       0.91      0.96      0.93     30293
weighted avg       0.99      0.98      0.99     30293

f1 0.8945176960444136 f1_masked 0.9018512050296892
{'eval_loss': 0.11175300925970078, 'eval_accuracy_score': 0.9848809956095468, 'eval_precision': 0.8627844712182061, 'eval_recall': 0.9286743515850144, 'eval_f1': 0.8945176960444136, 'eval_f1_masked': 0.9018512050296892, 'eval_runtime': 5.0001, 'eval_samples_per_second': 20.0, 'epoch': 22.0}
                                                   
 73%|███████▎  | 2948/4020 [25:09<07:22,  2.42it/s]
100%|██████████| 34/34 [00:04<00:00, 10.89it/s]
                                               Saving model checkpoint to ./results\checkpoint-2948
Configuration saved in ./results\checkpoint-2948\config.json
Model weights saved in ./results\checkpoint-2948\pytorch_model.bin
 73%|███████▎  | 2950/4020 [25:13<41:22,  2.32s/it]{'loss': 0.0012, 'learning_rate': 1.5198863636363636e-05, 'epoch': 22.01}
 74%|███████▎  | 2960/4020 [25:18<08:43,  2.03it/s]{'loss': 0.0002, 'learning_rate': 1.5056818181818182e-05, 'epoch': 22.09}
 74%|███████▍  | 2970/4020 [25:22<08:06,  2.16it/s]{'loss': 0.0005, 'learning_rate': 1.4914772727272727e-05, 'epoch': 22.16}
 74%|███████▍  | 2980/4020 [25:27<07:59,  2.17it/s]{'loss': 0.0001, 'learning_rate': 1.4772727272727274e-05, 'epoch': 22.24}
 74%|███████▍  | 2990/4020 [25:31<07:37,  2.25it/s]{'loss': 0.0153, 'learning_rate': 1.4630681818181818e-05, 'epoch': 22.31}
 75%|███████▍  | 3000/4020 [25:36<07:31,  2.26it/s]{'loss': 0.0015, 'learning_rate': 1.4488636363636366e-05, 'epoch': 22.39}
 75%|███████▍  | 3010/4020 [25:40<07:25,  2.27it/s]{'loss': 0.0011, 'learning_rate': 1.434659090909091e-05, 'epoch': 22.46}
 75%|███████▌  | 3020/4020 [25:45<07:32,  2.21it/s]{'loss': 0.0169, 'learning_rate': 1.4204545454545456e-05, 'epoch': 22.54}
 75%|███████▌  | 3030/4020 [25:49<07:30,  2.20it/s]{'loss': 0.0004, 'learning_rate': 1.4062500000000001e-05, 'epoch': 22.61}
 76%|███████▌  | 3040/4020 [25:54<07:25,  2.20it/s]{'loss': 0.001, 'learning_rate': 1.3920454545454545e-05, 'epoch': 22.69}
 76%|███████▌  | 3050/4020 [25:58<07:20,  2.20it/s]{'loss': 0.0011, 'learning_rate': 1.3778409090909091e-05, 'epoch': 22.76}
 76%|███████▌  | 3060/4020 [26:03<07:09,  2.24it/s]{'loss': 0.0009, 'learning_rate': 1.3636363636363637e-05, 'epoch': 22.84}
 76%|███████▋  | 3070/4020 [26:08<07:15,  2.18it/s]{'loss': 0.001, 'learning_rate': 1.3494318181818183e-05, 'epoch': 22.91}
 77%|███████▋  | 3080/4020 [26:12<07:08,  2.19it/s]{'loss': 0.0008, 'learning_rate': 1.3352272727272727e-05, 'epoch': 22.99}
 77%|███████▋  | 3082/4020 [26:13<06:38,  2.35it/s]***** Running Evaluation *****
  Num examples = 100
  Batch size = 3

  0%|          | 0/34 [00:00<?, ?it/s]
  9%|▉         | 3/34 [00:00<00:01, 16.00it/s]
 15%|█▍        | 5/34 [00:00<00:02, 13.53it/s]
 21%|██        | 7/34 [00:00<00:02, 12.19it/s]
 26%|██▋       | 9/34 [00:00<00:02, 11.58it/s]
 32%|███▏      | 11/34 [00:00<00:02, 11.18it/s]
 38%|███▊      | 13/34 [00:01<00:01, 10.81it/s]
 44%|████▍     | 15/34 [00:01<00:01, 10.79it/s]
 50%|█████     | 17/34 [00:01<00:01, 10.94it/s]
 56%|█████▌    | 19/34 [00:01<00:01, 10.83it/s]
 62%|██████▏   | 21/34 [00:01<00:01, 10.78it/s]
 68%|██████▊   | 23/34 [00:02<00:01, 10.62it/s]
 74%|███████▎  | 25/34 [00:02<00:00, 10.80it/s]
 79%|███████▉  | 27/34 [00:02<00:00, 11.04it/s]
 85%|████████▌ | 29/34 [00:02<00:00, 10.60it/s]
 91%|█████████ | 31/34 [00:02<00:00, 10.56it/s]
 97%|█████████▋| 33/34 [00:02<00:00, 10.70it/s]{'TP': 3106, 'FP': 349, 'FN': 113, 'TN': 26725}
C:\Users\aceite\anaconda3\envs\ner-noticias-mapa\lib\site-packages\sklearn\utils\validation.py:70: FutureWarning: Pass labels=['B-LOC', 'B-ORG', 'B-PESSOA', 'I-LOC', 'I-ORG', 'I-PESSOA', 'O'] as keyword args. From version 1.0 (renaming of 0.25) passing these as positional arguments will result in an error
  warnings.warn(f"Pass {args_msg} as keyword args. From version "
              precision    recall  f1-score   support

         LOC       0.86      0.91      0.88       279
         ORG       0.87      0.92      0.89       786
      PESSOA       0.86      0.97      0.91       323

   micro avg       0.86      0.93      0.90      1388
   macro avg       0.86      0.93      0.90      1388
weighted avg       0.86      0.93      0.89      1388

              precision    recall  f1-score   support

       B-LOC       0.87      0.92      0.90       277
       B-ORG       0.91      0.95      0.93       782
    B-PESSOA       0.88      0.98      0.93       322
       I-LOC       0.85      0.92      0.88       154
       I-ORG       0.90      0.93      0.92      1312
    I-PESSOA       0.92      0.98      0.95       434
           O       1.00      0.99      0.99     27012

    accuracy                           0.98     30293
   macro avg       0.90      0.95      0.93     30293
weighted avg       0.99      0.98      0.98     30293

f1 0.8950660180681029 f1_masked 0.9017138859741168
                                                   
 77%|███████▋  | 3082/4020 [26:18<06:38,  2.35it/s]
100%|██████████| 34/34 [00:04<00:00, 10.70it/s]
                                               Saving model checkpoint to ./results\checkpoint-3082
Configuration saved in ./results\checkpoint-3082\config.json
{'eval_loss': 0.11819383502006531, 'eval_accuracy_score': 0.9847489519030799, 'eval_precision': 0.8644295302013423, 'eval_recall': 0.9279538904899135, 'eval_f1': 0.8950660180681029, 'eval_f1_masked': 0.9017138859741168, 'eval_runtime': 5.0391, 'eval_samples_per_second': 19.845, 'epoch': 23.0}
Model weights saved in ./results\checkpoint-3082\pytorch_model.bin
 77%|███████▋  | 3090/4020 [26:26<10:44,  1.44it/s]{'loss': 0.0023, 'learning_rate': 1.3210227272727273e-05, 'epoch': 23.06}
 77%|███████▋  | 3100/4020 [26:31<07:08,  2.15it/s]{'loss': 0.0001, 'learning_rate': 1.3068181818181819e-05, 'epoch': 23.13}
 77%|███████▋  | 3110/4020 [26:35<06:51,  2.21it/s]{'loss': 0.0107, 'learning_rate': 1.2926136363636365e-05, 'epoch': 23.21}
 78%|███████▊  | 3120/4020 [26:40<06:43,  2.23it/s]{'loss': 0.0005, 'learning_rate': 1.2784090909090909e-05, 'epoch': 23.28}
 78%|███████▊  | 3130/4020 [26:44<06:39,  2.23it/s]{'loss': 0.0013, 'learning_rate': 1.2642045454545457e-05, 'epoch': 23.36}
 78%|███████▊  | 3140/4020 [26:49<06:36,  2.22it/s]{'loss': 0.0008, 'learning_rate': 1.25e-05, 'epoch': 23.43}
 78%|███████▊  | 3150/4020 [26:53<06:29,  2.23it/s]{'loss': 0.0007, 'learning_rate': 1.2357954545454546e-05, 'epoch': 23.51}
 79%|███████▊  | 3160/4020 [26:58<06:28,  2.21it/s]{'loss': 0.0006, 'learning_rate': 1.2215909090909092e-05, 'epoch': 23.58}
 79%|███████▉  | 3170/4020 [27:02<06:13,  2.27it/s]{'loss': 0.0065, 'learning_rate': 1.2073863636363638e-05, 'epoch': 23.66}
 79%|███████▉  | 3180/4020 [27:06<06:07,  2.28it/s]{'loss': 0.0, 'learning_rate': 1.1931818181818183e-05, 'epoch': 23.73}
 79%|███████▉  | 3190/4020 [27:11<06:03,  2.29it/s]{'loss': 0.0001, 'learning_rate': 1.1789772727272728e-05, 'epoch': 23.81}
 80%|███████▉  | 3200/4020 [27:15<05:56,  2.30it/s]{'loss': 0.0001, 'learning_rate': 1.1647727272727273e-05, 'epoch': 23.88}
 80%|███████▉  | 3210/4020 [27:20<05:59,  2.25it/s]{'loss': 0.0001, 'learning_rate': 1.1505681818181818e-05, 'epoch': 23.96}
 80%|████████  | 3216/4020 [27:22<05:29,  2.44it/s]***** Running Evaluation *****
  Num examples = 100
  Batch size = 3

  0%|          | 0/34 [00:00<?, ?it/s]
  9%|▉         | 3/34 [00:00<00:01, 17.46it/s]
 15%|█▍        | 5/34 [00:00<00:02, 13.32it/s]
 21%|██        | 7/34 [00:00<00:02, 12.57it/s]
 26%|██▋       | 9/34 [00:00<00:02, 11.80it/s]
 32%|███▏      | 11/34 [00:00<00:01, 11.73it/s]
 38%|███▊      | 13/34 [00:01<00:01, 11.27it/s]
 44%|████▍     | 15/34 [00:01<00:01, 11.48it/s]
 50%|█████     | 17/34 [00:01<00:01, 11.21it/s]
 56%|█████▌    | 19/34 [00:01<00:01, 11.04it/s]
 62%|██████▏   | 21/34 [00:01<00:01, 11.22it/s]
 68%|██████▊   | 23/34 [00:01<00:00, 11.04it/s]
 74%|███████▎  | 25/34 [00:02<00:00, 11.22it/s]
 79%|███████▉  | 27/34 [00:02<00:00, 11.05it/s]
 85%|████████▌ | 29/34 [00:02<00:00, 11.21it/s]
 91%|█████████ | 31/34 [00:02<00:00, 11.04it/s]
 97%|█████████▋| 33/34 [00:02<00:00, 11.22it/s]{'TP': 3102, 'FP': 333, 'FN': 120, 'TN': 26738}
C:\Users\aceite\anaconda3\envs\ner-noticias-mapa\lib\site-packages\sklearn\utils\validation.py:70: FutureWarning: Pass labels=['B-LOC', 'B-ORG', 'B-PESSOA', 'I-LOC', 'I-ORG', 'I-PESSOA', 'O'] as keyword args. From version 1.0 (renaming of 0.25) passing these as positional arguments will result in an error
  warnings.warn(f"Pass {args_msg} as keyword args. From version "
              precision    recall  f1-score   support

         LOC       0.85      0.94      0.89       279
         ORG       0.87      0.91      0.89       786
      PESSOA       0.85      0.97      0.91       323

   micro avg       0.86      0.93      0.89      1388
   macro avg       0.86      0.94      0.90      1388
weighted avg       0.86      0.93      0.89      1388

              precision    recall  f1-score   support

       B-LOC       0.87      0.94      0.90       277
       B-ORG       0.91      0.94      0.93       782
    B-PESSOA       0.88      0.98      0.93       322
       I-LOC       0.86      0.94      0.90       154
       I-ORG       0.91      0.93      0.92      1312
    I-PESSOA       0.92      0.98      0.95       434
           O       1.00      0.99      0.99     27012

    accuracy                           0.99     30293
   macro avg       0.91      0.96      0.93     30293
weighted avg       0.99      0.99      0.99     30293

f1 0.8928942807625649 f1_masked 0.9006993006993007
                                                   
 80%|████████  | 3216/4020 [27:27<05:29,  2.44it/s]
100%|██████████| 34/34 [00:04<00:00, 11.22it/s]
                                               Saving model checkpoint to ./results\checkpoint-3216
Configuration saved in ./results\checkpoint-3216\config.json
{'eval_loss': 0.11959045380353928, 'eval_accuracy_score': 0.9850460502426303, 'eval_precision': 0.8603874415497662, 'eval_recall': 0.9279538904899135, 'eval_f1': 0.8928942807625649, 'eval_f1_masked': 0.9006993006993007, 'eval_runtime': 4.8751, 'eval_samples_per_second': 20.512, 'epoch': 24.0}
Model weights saved in ./results\checkpoint-3216\pytorch_model.bin
 80%|████████  | 3220/4020 [27:33<17:59,  1.35s/it]{'loss': 0.0007, 'learning_rate': 1.1363636363636365e-05, 'epoch': 24.03}
 80%|████████  | 3230/4020 [27:37<06:12,  2.12it/s]{'loss': 0.0006, 'learning_rate': 1.122159090909091e-05, 'epoch': 24.1}
 81%|████████  | 3240/4020 [27:42<05:50,  2.22it/s]{'loss': 0.0015, 'learning_rate': 1.1079545454545455e-05, 'epoch': 24.18}
 81%|████████  | 3250/4020 [27:46<05:51,  2.19it/s]{'loss': 0.0003, 'learning_rate': 1.09375e-05, 'epoch': 24.25}
 81%|████████  | 3260/4020 [27:51<05:42,  2.22it/s]{'loss': 0.0002, 'learning_rate': 1.0795454545454547e-05, 'epoch': 24.33}
 81%|████████▏ | 3270/4020 [27:55<05:29,  2.27it/s]{'loss': 0.0003, 'learning_rate': 1.0653409090909092e-05, 'epoch': 24.4}
 82%|████████▏ | 3280/4020 [28:00<05:22,  2.29it/s]{'loss': 0.0005, 'learning_rate': 1.0511363636363637e-05, 'epoch': 24.48}
 82%|████████▏ | 3290/4020 [28:04<05:20,  2.28it/s]{'loss': 0.0006, 'learning_rate': 1.0369318181818184e-05, 'epoch': 24.55}
 82%|████████▏ | 3300/4020 [28:08<05:11,  2.31it/s]{'loss': 0.0053, 'learning_rate': 1.0227272727272729e-05, 'epoch': 24.63}
 82%|████████▏ | 3310/4020 [28:13<05:08,  2.30it/s]{'loss': 0.0007, 'learning_rate': 1.0085227272727272e-05, 'epoch': 24.7}
 83%|████████▎ | 3320/4020 [28:17<05:14,  2.23it/s]{'loss': 0.0005, 'learning_rate': 9.943181818181819e-06, 'epoch': 24.78}
 83%|████████▎ | 3330/4020 [28:21<04:58,  2.31it/s]{'loss': 0.0003, 'learning_rate': 9.801136363636364e-06, 'epoch': 24.85}
 83%|████████▎ | 3340/4020 [28:26<04:57,  2.29it/s]{'loss': 0.0083, 'learning_rate': 9.659090909090909e-06, 'epoch': 24.93}
 83%|████████▎ | 3350/4020 [28:30<04:30,  2.47it/s]***** Running Evaluation *****
{'loss': 0.0016, 'learning_rate': 9.517045454545454e-06, 'epoch': 25.0}
  Num examples = 100
  Batch size = 3

  0%|          | 0/34 [00:00<?, ?it/s]
  9%|▉         | 3/34 [00:00<00:01, 15.99it/s]
 15%|█▍        | 5/34 [00:00<00:02, 12.86it/s]
 21%|██        | 7/34 [00:00<00:02, 11.86it/s]
 26%|██▋       | 9/34 [00:00<00:02, 11.78it/s]
 32%|███▏      | 11/34 [00:00<00:02, 11.37it/s]
 38%|███▊      | 13/34 [00:01<00:01, 11.13it/s]
 44%|████▍     | 15/34 [00:01<00:01, 10.98it/s]
 50%|█████     | 17/34 [00:01<00:01, 11.17it/s]
 56%|█████▌    | 19/34 [00:01<00:01, 11.01it/s]
 62%|██████▏   | 21/34 [00:01<00:01, 10.90it/s]
 68%|██████▊   | 23/34 [00:02<00:01, 10.83it/s]
 74%|███████▎  | 25/34 [00:02<00:00, 11.06it/s]
 79%|███████▉  | 27/34 [00:02<00:00, 10.94it/s]
 85%|████████▌ | 29/34 [00:02<00:00, 10.86it/s]
 91%|█████████ | 31/34 [00:02<00:00, 10.80it/s]
 97%|█████████▋| 33/34 [00:02<00:00, 11.04it/s]{'TP': 3109, 'FP': 333, 'FN': 115, 'TN': 26736}
              precision    recall  f1-score   support

         LOC       0.86      0.93      0.89       279
         ORG       0.87      0.91      0.89       786
      PESSOA       0.86      0.96      0.91       323

   micro avg       0.86      0.93      0.89      1388
   macro avg       0.86      0.94      0.90      1388
weighted avg       0.86      0.93      0.89      1388

C:\Users\aceite\anaconda3\envs\ner-noticias-mapa\lib\site-packages\sklearn\utils\validation.py:70: FutureWarning: Pass labels=['B-LOC', 'B-ORG', 'B-PESSOA', 'I-LOC', 'I-ORG', 'I-PESSOA', 'O'] as keyword args. From version 1.0 (renaming of 0.25) passing these as positional arguments will result in an error
  warnings.warn(f"Pass {args_msg} as keyword args. From version "
              precision    recall  f1-score   support

       B-LOC       0.87      0.94      0.90       277
       B-ORG       0.91      0.95      0.93       782
    B-PESSOA       0.88      0.98      0.93       322
       I-LOC       0.86      0.94      0.90       154
       I-ORG       0.91      0.93      0.92      1312
    I-PESSOA       0.92      0.98      0.95       434
           O       1.00      0.99      0.99     27012

    accuracy                           0.99     30293
   macro avg       0.91      0.96      0.93     30293
weighted avg       0.99      0.99      0.99     30293

f1 0.8948281846581048 f1_masked 0.9013296011196642
                                                   
 83%|████████▎ | 3350/4020 [28:35<04:30,  2.47it/s]
100%|██████████| 34/34 [00:04<00:00, 11.04it/s]
                                               Saving model checkpoint to ./results\checkpoint-3350
Configuration saved in ./results\checkpoint-3350\config.json
{'eval_loss': 0.11968813091516495, 'eval_accuracy_score': 0.9852111048757138, 'eval_precision': 0.8633623576691226, 'eval_recall': 0.9286743515850144, 'eval_f1': 0.8948281846581048, 'eval_f1_masked': 0.9013296011196642, 'eval_runtime': 4.9219, 'eval_samples_per_second': 20.318, 'epoch': 25.0}
Model weights saved in ./results\checkpoint-3350\pytorch_model.bin
 84%|████████▎ | 3360/4020 [28:43<06:00,  1.83it/s]{'loss': 0.0003, 'learning_rate': 9.375000000000001e-06, 'epoch': 25.07}
 84%|████████▍ | 3370/4020 [28:48<04:47,  2.26it/s]{'loss': 0.0, 'learning_rate': 9.232954545454546e-06, 'epoch': 25.15}
 84%|████████▍ | 3380/4020 [28:52<04:38,  2.30it/s]{'loss': 0.0083, 'learning_rate': 9.090909090909091e-06, 'epoch': 25.22}
 84%|████████▍ | 3390/4020 [28:57<04:34,  2.30it/s]{'loss': 0.0004, 'learning_rate': 8.948863636363638e-06, 'epoch': 25.3}
 85%|████████▍ | 3400/4020 [29:01<04:30,  2.29it/s]{'loss': 0.0, 'learning_rate': 8.806818181818183e-06, 'epoch': 25.37}
 85%|████████▍ | 3410/4020 [29:05<04:35,  2.21it/s]{'loss': 0.0, 'learning_rate': 8.664772727272728e-06, 'epoch': 25.45}
 85%|████████▌ | 3420/4020 [29:10<04:22,  2.28it/s]{'loss': 0.0, 'learning_rate': 8.522727272727273e-06, 'epoch': 25.52}
 85%|████████▌ | 3430/4020 [29:14<04:25,  2.22it/s]{'loss': 0.0001, 'learning_rate': 8.380681818181818e-06, 'epoch': 25.6}
 86%|████████▌ | 3440/4020 [29:19<04:13,  2.29it/s]{'loss': 0.0009, 'learning_rate': 8.238636363636363e-06, 'epoch': 25.67}
 86%|████████▌ | 3450/4020 [29:23<04:09,  2.28it/s]{'loss': 0.0015, 'learning_rate': 8.09659090909091e-06, 'epoch': 25.75}
 86%|████████▌ | 3460/4020 [29:27<04:02,  2.31it/s]{'loss': 0.0006, 'learning_rate': 7.954545454545455e-06, 'epoch': 25.82}
 86%|████████▋ | 3470/4020 [29:32<04:05,  2.24it/s]{'loss': 0.0042, 'learning_rate': 7.8125e-06, 'epoch': 25.9}
 87%|████████▋ | 3480/4020 [29:36<03:59,  2.26it/s]{'loss': 0.0007, 'learning_rate': 7.670454545454545e-06, 'epoch': 25.97}
 87%|████████▋ | 3484/4020 [29:38<03:43,  2.40it/s]***** Running Evaluation *****
  Num examples = 100
  Batch size = 3

  0%|          | 0/34 [00:00<?, ?it/s]
  9%|▉         | 3/34 [00:00<00:01, 17.42it/s]
 15%|█▍        | 5/34 [00:00<00:02, 13.31it/s]
 21%|██        | 7/34 [00:00<00:02, 12.09it/s]
 26%|██▋       | 9/34 [00:00<00:02, 11.52it/s]
 32%|███▏      | 11/34 [00:00<00:01, 11.56it/s]
 38%|███▊      | 13/34 [00:01<00:01, 11.25it/s]
 44%|████▍     | 15/34 [00:01<00:01, 11.05it/s]
 50%|█████     | 17/34 [00:01<00:01, 11.23it/s]
 56%|█████▌    | 19/34 [00:01<00:01, 11.05it/s]
 62%|██████▏   | 21/34 [00:01<00:01, 10.93it/s]
 68%|██████▊   | 23/34 [00:02<00:01, 10.85it/s]
 74%|███████▎  | 25/34 [00:02<00:00, 10.48it/s]
 79%|███████▉  | 27/34 [00:02<00:00, 10.46it/s]
 85%|████████▌ | 29/34 [00:02<00:00, 10.64it/s]
 91%|█████████ | 31/34 [00:02<00:00, 10.65it/s]
 97%|█████████▋| 33/34 [00:02<00:00, 10.93it/s]{'TP': 3109, 'FP': 332, 'FN': 115, 'TN': 26737}
C:\Users\aceite\anaconda3\envs\ner-noticias-mapa\lib\site-packages\sklearn\utils\validation.py:70: FutureWarning: Pass labels=['B-LOC', 'B-ORG', 'B-PESSOA', 'I-LOC', 'I-ORG', 'I-PESSOA', 'O'] as keyword args. From version 1.0 (renaming of 0.25) passing these as positional arguments will result in an error
  warnings.warn(f"Pass {args_msg} as keyword args. From version "
              precision    recall  f1-score   support

         LOC       0.85      0.94      0.89       279
         ORG       0.86      0.91      0.89       786
      PESSOA       0.86      0.97      0.91       323

   micro avg       0.86      0.93      0.89      1388
   macro avg       0.86      0.94      0.90      1388
weighted avg       0.86      0.93      0.89      1388

              precision    recall  f1-score   support

       B-LOC       0.86      0.94      0.90       277
       B-ORG       0.91      0.95      0.93       782
    B-PESSOA       0.88      0.98      0.93       322
       I-LOC       0.86      0.95      0.90       154
       I-ORG       0.91      0.93      0.92      1312
    I-PESSOA       0.92      0.98      0.95       434
           O       1.00      0.99      0.99     27012

    accuracy                           0.99     30293
   macro avg       0.91      0.96      0.93     30293
weighted avg       0.99      0.99      0.99     30293

f1 0.8943540006927607 f1_masked 0.8998254799301919
                                                   
 87%|████████▋ | 3484/4020 [29:43<03:43,  2.40it/s]
100%|██████████| 34/34 [00:04<00:00, 10.93it/s]
                                               Saving model checkpoint to ./results\checkpoint-3484
Configuration saved in ./results\checkpoint-3484\config.json
{'eval_loss': 0.12224381417036057, 'eval_accuracy_score': 0.9852441158023306, 'eval_precision': 0.8612408272181454, 'eval_recall': 0.9301152737752162, 'eval_f1': 0.8943540006927607, 'eval_f1_masked': 0.8998254799301919, 'eval_runtime': 4.9531, 'eval_samples_per_second': 20.189, 'epoch': 26.0}
Model weights saved in ./results\checkpoint-3484\pytorch_model.bin
 87%|████████▋ | 3490/4020 [29:50<07:58,  1.11it/s]{'loss': 0.0, 'learning_rate': 7.528409090909091e-06, 'epoch': 26.04}
 87%|████████▋ | 3500/4020 [29:54<03:56,  2.20it/s]{'loss': 0.0041, 'learning_rate': 7.386363636363637e-06, 'epoch': 26.12}
 87%|████████▋ | 3510/4020 [29:58<03:41,  2.30it/s]{'loss': 0.0011, 'learning_rate': 7.244318181818183e-06, 'epoch': 26.19}
 88%|████████▊ | 3520/4020 [30:03<03:37,  2.30it/s]{'loss': 0.0001, 'learning_rate': 7.102272727272728e-06, 'epoch': 26.27}
 88%|████████▊ | 3530/4020 [30:07<03:31,  2.32it/s]{'loss': 0.0006, 'learning_rate': 6.960227272727272e-06, 'epoch': 26.34}
 88%|████████▊ | 3540/4020 [30:11<03:29,  2.30it/s]{'loss': 0.0001, 'learning_rate': 6.818181818181818e-06, 'epoch': 26.42}
 88%|████████▊ | 3550/4020 [30:16<03:27,  2.26it/s]{'loss': 0.0089, 'learning_rate': 6.676136363636363e-06, 'epoch': 26.49}
 89%|████████▊ | 3560/4020 [30:20<03:19,  2.31it/s]{'loss': 0.0, 'learning_rate': 6.534090909090909e-06, 'epoch': 26.57}
 89%|████████▉ | 3570/4020 [30:25<03:18,  2.26it/s]{'loss': 0.0004, 'learning_rate': 6.392045454545454e-06, 'epoch': 26.64}
 89%|████████▉ | 3580/4020 [30:29<03:12,  2.29it/s]{'loss': 0.0007, 'learning_rate': 6.25e-06, 'epoch': 26.72}
 89%|████████▉ | 3590/4020 [30:33<03:07,  2.29it/s]{'loss': 0.0008, 'learning_rate': 6.107954545454546e-06, 'epoch': 26.79}
 90%|████████▉ | 3600/4020 [30:38<03:01,  2.31it/s]{'loss': 0.0004, 'learning_rate': 5.965909090909091e-06, 'epoch': 26.87}
 90%|████████▉ | 3610/4020 [30:42<02:59,  2.29it/s]{'loss': 0.0005, 'learning_rate': 5.823863636363636e-06, 'epoch': 26.94}
 90%|█████████ | 3618/4020 [30:45<02:42,  2.47it/s]***** Running Evaluation *****
  Num examples = 100
  Batch size = 3

  0%|          | 0/34 [00:00<?, ?it/s]
  9%|▉         | 3/34 [00:00<00:01, 16.00it/s]
 15%|█▍        | 5/34 [00:00<00:02, 12.86it/s]
 21%|██        | 7/34 [00:00<00:02, 12.32it/s]
 26%|██▋       | 9/34 [00:00<00:02, 11.66it/s]
 32%|███▏      | 11/34 [00:00<00:02, 11.30it/s]
 38%|███▊      | 13/34 [00:01<00:01, 11.41it/s]
 44%|████▍     | 15/34 [00:01<00:01, 11.16it/s]
 50%|█████     | 17/34 [00:01<00:01, 11.00it/s]
 56%|█████▌    | 19/34 [00:01<00:01, 10.89it/s]
 62%|██████▏   | 21/34 [00:01<00:01, 11.11it/s]
 68%|██████▊   | 23/34 [00:02<00:01, 10.97it/s]
 74%|███████▎  | 25/34 [00:02<00:00, 10.87it/s]
 79%|███████▉  | 27/34 [00:02<00:00, 10.81it/s]
 85%|████████▌ | 29/34 [00:02<00:00, 11.05it/s]
 91%|█████████ | 31/34 [00:02<00:00, 10.93it/s]
 97%|█████████▋| 33/34 [00:02<00:00, 10.85it/s]{'TP': 3096, 'FP': 311, 'FN': 127, 'TN': 26759}
              precision    recall  f1-score   support

         LOC       0.85      0.94      0.89       279
         ORG       0.87      0.91      0.89       786
      PESSOA       0.86      0.97      0.91       323

   micro avg       0.87      0.93      0.90      1388
   macro avg       0.86      0.94      0.90      1388
weighted avg       0.87      0.93      0.90      1388

C:\Users\aceite\anaconda3\envs\ner-noticias-mapa\lib\site-packages\sklearn\utils\validation.py:70: FutureWarning: Pass labels=['B-LOC', 'B-ORG', 'B-PESSOA', 'I-LOC', 'I-ORG', 'I-PESSOA', 'O'] as keyword args. From version 1.0 (renaming of 0.25) passing these as positional arguments will result in an error
  warnings.warn(f"Pass {args_msg} as keyword args. From version "
              precision    recall  f1-score   support

       B-LOC       0.86      0.94      0.90       277
       B-ORG       0.92      0.94      0.93       782
    B-PESSOA       0.88      0.98      0.93       322
       I-LOC       0.86      0.95      0.90       154
       I-ORG       0.93      0.92      0.92      1312
    I-PESSOA       0.92      0.98      0.95       434
           O       1.00      0.99      0.99     27012

    accuracy                           0.99     30293
   macro avg       0.91      0.96      0.93     30293
weighted avg       0.99      0.99      0.99     30293

f1 0.8971507991660876 f1_masked 0.9010143406785589
                                                   
 90%|█████████ | 3618/4020 [30:50<02:42,  2.47it/s]
100%|██████████| 34/34 [00:04<00:00, 10.85it/s]
                                               Saving model checkpoint to ./results\checkpoint-3618
Configuration saved in ./results\checkpoint-3618\config.json
{'eval_loss': 0.1217256635427475, 'eval_accuracy_score': 0.985541214141881, 'eval_precision': 0.8664429530201342, 'eval_recall': 0.9301152737752162, 'eval_f1': 0.8971507991660876, 'eval_f1_masked': 0.9010143406785589, 'eval_runtime': 4.9375, 'eval_samples_per_second': 20.253, 'epoch': 27.0}
Model weights saved in ./results\checkpoint-3618\pytorch_model.bin
 90%|█████████ | 3620/4020 [30:56<15:46,  2.37s/it]{'loss': 0.0, 'learning_rate': 5.681818181818182e-06, 'epoch': 27.01}
 90%|█████████ | 3630/4020 [31:00<03:11,  2.03it/s]{'loss': 0.0, 'learning_rate': 5.539772727272727e-06, 'epoch': 27.09}
 91%|█████████ | 3640/4020 [31:04<02:51,  2.22it/s]{'loss': 0.0, 'learning_rate': 5.397727272727273e-06, 'epoch': 27.16}
 91%|█████████ | 3650/4020 [31:09<02:46,  2.22it/s]{'loss': 0.0, 'learning_rate': 5.255681818181818e-06, 'epoch': 27.24}
 91%|█████████ | 3660/4020 [31:13<02:39,  2.26it/s]{'loss': 0.0004, 'learning_rate': 5.113636363636364e-06, 'epoch': 27.31}
 91%|█████████▏| 3670/4020 [31:18<02:37,  2.23it/s]{'loss': 0.004, 'learning_rate': 4.9715909090909094e-06, 'epoch': 27.39}
 92%|█████████▏| 3680/4020 [31:22<02:29,  2.27it/s]{'loss': 0.0009, 'learning_rate': 4.8295454545454545e-06, 'epoch': 27.46}
 92%|█████████▏| 3690/4020 [31:27<02:27,  2.24it/s]{'loss': 0.0013, 'learning_rate': 4.6875000000000004e-06, 'epoch': 27.54}
 92%|█████████▏| 3700/4020 [31:31<02:21,  2.27it/s]{'loss': 0.0014, 'learning_rate': 4.5454545454545455e-06, 'epoch': 27.61}
 92%|█████████▏| 3710/4020 [31:36<02:18,  2.24it/s]{'loss': 0.0087, 'learning_rate': 4.4034090909090914e-06, 'epoch': 27.69}
 93%|█████████▎| 3720/4020 [31:40<02:13,  2.24it/s]{'loss': 0.0009, 'learning_rate': 4.2613636363636365e-06, 'epoch': 27.76}
 93%|█████████▎| 3730/4020 [31:45<02:09,  2.23it/s]{'loss': 0.0001, 'learning_rate': 4.119318181818182e-06, 'epoch': 27.84}
 93%|█████████▎| 3740/4020 [31:49<02:02,  2.29it/s]{'loss': 0.0005, 'learning_rate': 3.9772727272727275e-06, 'epoch': 27.91}
 93%|█████████▎| 3750/4020 [31:53<01:56,  2.32it/s]{'loss': 0.0, 'learning_rate': 3.835227272727273e-06, 'epoch': 27.99}
 93%|█████████▎| 3752/4020 [31:54<01:47,  2.49it/s]***** Running Evaluation *****
  Num examples = 100
  Batch size = 3

  0%|          | 0/34 [00:00<?, ?it/s]
  9%|▉         | 3/34 [00:00<00:01, 16.00it/s]
 15%|█▍        | 5/34 [00:00<00:02, 12.85it/s]
 21%|██        | 7/34 [00:00<00:02, 11.86it/s]
 26%|██▋       | 9/34 [00:00<00:02, 11.78it/s]
 32%|███▏      | 11/34 [00:00<00:02, 11.36it/s]
 38%|███▊      | 13/34 [00:01<00:01, 11.46it/s]
 44%|████▍     | 15/34 [00:01<00:01, 11.19it/s]
 50%|█████     | 17/34 [00:01<00:01, 11.02it/s]
 56%|█████▌    | 19/34 [00:01<00:01, 10.91it/s]
 62%|██████▏   | 21/34 [00:01<00:01, 11.12it/s]
 68%|██████▊   | 23/34 [00:02<00:01, 10.98it/s]
 74%|███████▎  | 25/34 [00:02<00:00, 10.88it/s]
 79%|███████▉  | 27/34 [00:02<00:00, 11.10it/s]
 85%|████████▌ | 29/34 [00:02<00:00, 10.97it/s]
 91%|█████████ | 31/34 [00:02<00:00, 10.87it/s]
 97%|█████████▋| 33/34 [00:02<00:00, 11.09it/s]{'TP': 3103, 'FP': 334, 'FN': 120, 'TN': 26736}
C:\Users\aceite\anaconda3\envs\ner-noticias-mapa\lib\site-packages\sklearn\utils\validation.py:70: FutureWarning: Pass labels=['B-LOC', 'B-ORG', 'B-PESSOA', 'I-LOC', 'I-ORG', 'I-PESSOA', 'O'] as keyword args. From version 1.0 (renaming of 0.25) passing these as positional arguments will result in an error
  warnings.warn(f"Pass {args_msg} as keyword args. From version "
              precision    recall  f1-score   support

         LOC       0.85      0.94      0.89       279
         ORG       0.87      0.91      0.89       786
      PESSOA       0.86      0.97      0.91       323

   micro avg       0.86      0.93      0.90      1388
   macro avg       0.86      0.94      0.90      1388
weighted avg       0.86      0.93      0.90      1388

              precision    recall  f1-score   support

       B-LOC       0.86      0.94      0.90       277
       B-ORG       0.91      0.95      0.93       782
    B-PESSOA       0.88      0.98      0.93       322
       I-LOC       0.86      0.95      0.90       154
       I-ORG       0.91      0.93      0.92      1312
    I-PESSOA       0.92      0.98      0.95       434
           O       1.00      0.99      0.99     27012

    accuracy                           0.99     30293
   macro avg       0.91      0.96      0.93     30293
weighted avg       0.99      0.99      0.99     30293

f1 0.8953568953568953 f1_masked 0.9011526370939573
                                                   
 93%|█████████▎| 3752/4020 [31:59<01:47,  2.49it/s]
100%|██████████| 34/34 [00:04<00:00, 11.09it/s]
                                               Saving model checkpoint to ./results\checkpoint-3752
Configuration saved in ./results\checkpoint-3752\config.json
{'eval_loss': 0.12358451634645462, 'eval_accuracy_score': 0.9850130393160136, 'eval_precision': 0.8624833110814419, 'eval_recall': 0.930835734870317, 'eval_f1': 0.8953568953568953, 'eval_f1_masked': 0.9011526370939573, 'eval_runtime': 4.9061, 'eval_samples_per_second': 20.383, 'epoch': 28.0}
Model weights saved in ./results\checkpoint-3752\pytorch_model.bin
 94%|█████████▎| 3760/4020 [32:07<02:50,  1.53it/s]{'loss': 0.0048, 'learning_rate': 3.6931818181818186e-06, 'epoch': 28.06}
 94%|█████████▍| 3770/4020 [32:11<01:55,  2.17it/s]{'loss': 0.0, 'learning_rate': 3.551136363636364e-06, 'epoch': 28.13}
 94%|█████████▍| 3780/4020 [32:16<01:46,  2.26it/s]{'loss': 0.0017, 'learning_rate': 3.409090909090909e-06, 'epoch': 28.21}
 94%|█████████▍| 3790/4020 [32:20<01:40,  2.28it/s]{'loss': 0.0001, 'learning_rate': 3.2670454545454546e-06, 'epoch': 28.28}
 95%|█████████▍| 3800/4020 [32:25<01:36,  2.27it/s]{'loss': 0.0006, 'learning_rate': 3.125e-06, 'epoch': 28.36}
 95%|█████████▍| 3810/4020 [32:29<01:32,  2.27it/s]{'loss': 0.0004, 'learning_rate': 2.9829545454545457e-06, 'epoch': 28.43}
 95%|█████████▌| 3820/4020 [32:33<01:27,  2.28it/s]{'loss': 0.0006, 'learning_rate': 2.840909090909091e-06, 'epoch': 28.51}
 95%|█████████▌| 3830/4020 [32:38<01:22,  2.31it/s]{'loss': 0.0015, 'learning_rate': 2.6988636363636367e-06, 'epoch': 28.58}
 96%|█████████▌| 3840/4020 [32:42<01:17,  2.31it/s]{'loss': 0.0003, 'learning_rate': 2.556818181818182e-06, 'epoch': 28.66}
 96%|█████████▌| 3850/4020 [32:46<01:13,  2.30it/s]{'loss': 0.0001, 'learning_rate': 2.4147727272727273e-06, 'epoch': 28.73}
 96%|█████████▌| 3860/4020 [32:51<01:09,  2.30it/s]{'loss': 0.0011, 'learning_rate': 2.2727272727272728e-06, 'epoch': 28.81}
 96%|█████████▋| 3870/4020 [32:55<01:05,  2.31it/s]{'loss': 0.0007, 'learning_rate': 2.1306818181818183e-06, 'epoch': 28.88}
 97%|█████████▋| 3880/4020 [32:59<01:00,  2.30it/s]{'loss': 0.0036, 'learning_rate': 1.9886363636363638e-06, 'epoch': 28.96}
 97%|█████████▋| 3886/4020 [33:02<00:54,  2.47it/s]***** Running Evaluation *****
  Num examples = 100
  Batch size = 3

  0%|          | 0/34 [00:00<?, ?it/s]
  9%|▉         | 3/34 [00:00<00:01, 17.46it/s]
 15%|█▍        | 5/34 [00:00<00:02, 13.32it/s]
 21%|██        | 7/34 [00:00<00:02, 12.57it/s]
 26%|██▋       | 9/34 [00:00<00:02, 11.79it/s]
 32%|███▏      | 11/34 [00:00<00:02, 11.38it/s]
 38%|███▊      | 13/34 [00:01<00:01, 11.46it/s]
 44%|████▍     | 15/34 [00:01<00:01, 11.19it/s]
 50%|█████     | 17/34 [00:01<00:01, 11.02it/s]
 56%|█████▌    | 19/34 [00:01<00:01, 11.21it/s]
 62%|██████▏   | 21/34 [00:01<00:01, 11.04it/s]
 68%|██████▊   | 23/34 [00:02<00:01, 10.92it/s]
 74%|███████▎  | 25/34 [00:02<00:00, 11.12it/s]
 79%|███████▉  | 27/34 [00:02<00:00, 10.97it/s]
 85%|████████▌ | 29/34 [00:02<00:00, 11.18it/s]
 91%|█████████ | 31/34 [00:02<00:00, 11.02it/s]
 97%|█████████▋| 33/34 [00:02<00:00, 10.90it/s]{'TP': 3097, 'FP': 319, 'FN': 126, 'TN': 26751}
              precision    recall  f1-score   support

         LOC       0.85      0.94      0.89       279
         ORG       0.87      0.91      0.89       786
      PESSOA       0.86      0.97      0.91       323

   micro avg       0.87      0.93      0.90      1388
   macro avg       0.86      0.94      0.90      1388
weighted avg       0.87      0.93      0.90      1388

C:\Users\aceite\anaconda3\envs\ner-noticias-mapa\lib\site-packages\sklearn\utils\validation.py:70: FutureWarning: Pass labels=['B-LOC', 'B-ORG', 'B-PESSOA', 'I-LOC', 'I-ORG', 'I-PESSOA', 'O'] as keyword args. From version 1.0 (renaming of 0.25) passing these as positional arguments will result in an error
  warnings.warn(f"Pass {args_msg} as keyword args. From version "
              precision    recall  f1-score   support

       B-LOC       0.86      0.94      0.90       277
       B-ORG       0.92      0.94      0.93       782
    B-PESSOA       0.88      0.98      0.93       322
       I-LOC       0.86      0.95      0.90       154
       I-ORG       0.92      0.92      0.92      1312
    I-PESSOA       0.92      0.98      0.95       434
           O       1.00      0.99      0.99     27012

    accuracy                           0.99     30293
   macro avg       0.91      0.96      0.93     30293
weighted avg       0.99      0.99      0.99     30293

f1 0.8960722975321516 f1_masked 0.8996152500874431
                                                   
 97%|█████████▋| 3886/4020 [33:07<00:54,  2.47it/s]
100%|██████████| 34/34 [00:04<00:00, 10.90it/s]
                                               Saving model checkpoint to ./results\checkpoint-3886
Configuration saved in ./results\checkpoint-3886\config.json
{'eval_loss': 0.12301025539636612, 'eval_accuracy_score': 0.985310137655564, 'eval_precision': 0.8656816655473473, 'eval_recall': 0.9286743515850144, 'eval_f1': 0.8960722975321516, 'eval_f1_masked': 0.8996152500874431, 'eval_runtime': 4.8909, 'eval_samples_per_second': 20.446, 'epoch': 29.0}
Model weights saved in ./results\checkpoint-3886\pytorch_model.bin
 97%|█████████▋| 3890/4020 [33:13<02:55,  1.35s/it]{'loss': 0.0, 'learning_rate': 1.8465909090909093e-06, 'epoch': 29.03}
 97%|█████████▋| 3900/4020 [33:17<00:55,  2.16it/s]{'loss': 0.0007, 'learning_rate': 1.7045454545454546e-06, 'epoch': 29.1}
 97%|█████████▋| 3910/4020 [33:21<00:49,  2.21it/s]{'loss': 0.0003, 'learning_rate': 1.5625e-06, 'epoch': 29.18}
 98%|█████████▊| 3920/4020 [33:26<00:45,  2.19it/s]{'loss': 0.0009, 'learning_rate': 1.4204545454545456e-06, 'epoch': 29.25}
 98%|█████████▊| 3930/4020 [33:31<00:41,  2.16it/s]{'loss': 0.0001, 'learning_rate': 1.278409090909091e-06, 'epoch': 29.33}
 98%|█████████▊| 3940/4020 [33:35<00:35,  2.28it/s]{'loss': 0.0003, 'learning_rate': 1.1363636363636364e-06, 'epoch': 29.4}
 98%|█████████▊| 3950/4020 [33:39<00:30,  2.30it/s]{'loss': 0.0001, 'learning_rate': 9.943181818181819e-07, 'epoch': 29.48}
 99%|█████████▊| 3960/4020 [33:44<00:25,  2.32it/s]{'loss': 0.0001, 'learning_rate': 8.522727272727273e-07, 'epoch': 29.55}
 99%|█████████▉| 3970/4020 [33:48<00:21,  2.30it/s]{'loss': 0.0003, 'learning_rate': 7.102272727272728e-07, 'epoch': 29.63}
 99%|█████████▉| 3980/4020 [33:52<00:17,  2.29it/s]{'loss': 0.004, 'learning_rate': 5.681818181818182e-07, 'epoch': 29.7}
 99%|█████████▉| 3990/4020 [33:57<00:13,  2.29it/s]{'loss': 0.0002, 'learning_rate': 4.2613636363636364e-07, 'epoch': 29.78}
100%|█████████▉| 4000/4020 [34:01<00:08,  2.31it/s]{'loss': 0.0006, 'learning_rate': 2.840909090909091e-07, 'epoch': 29.85}
100%|█████████▉| 4010/4020 [34:05<00:04,  2.32it/s]{'loss': 0.0061, 'learning_rate': 1.4204545454545455e-07, 'epoch': 29.93}
100%|██████████| 4020/4020 [34:10<00:00,  2.48it/s]***** Running Evaluation *****
{'loss': 0.0003, 'learning_rate': 0.0, 'epoch': 30.0}
  Num examples = 100
  Batch size = 3

  0%|          | 0/34 [00:00<?, ?it/s]
  9%|▉         | 3/34 [00:00<00:01, 16.00it/s]
 15%|█▍        | 5/34 [00:00<00:02, 13.53it/s]
 21%|██        | 7/34 [00:00<00:02, 12.17it/s]
 26%|██▋       | 9/34 [00:00<00:02, 11.58it/s]
 32%|███▏      | 11/34 [00:00<00:01, 11.60it/s]
 38%|███▊      | 13/34 [00:01<00:01, 11.26it/s]
 44%|████▍     | 15/34 [00:01<00:01, 11.07it/s]
 50%|█████     | 17/34 [00:01<00:01, 11.24it/s]
 56%|█████▌    | 19/34 [00:01<00:01, 11.06it/s]
 62%|██████▏   | 21/34 [00:01<00:01, 10.93it/s]
 68%|██████▊   | 23/34 [00:02<00:01, 10.85it/s]
 74%|███████▎  | 25/34 [00:02<00:00, 11.08it/s]
 79%|███████▉  | 27/34 [00:02<00:00, 10.95it/s]
 85%|████████▌ | 29/34 [00:02<00:00, 10.86it/s]
 91%|█████████ | 31/34 [00:02<00:00, 11.09it/s]
 97%|█████████▋| 33/34 [00:02<00:00, 10.96it/s]{'TP': 3097, 'FP': 322, 'FN': 126, 'TN': 26748}
C:\Users\aceite\anaconda3\envs\ner-noticias-mapa\lib\site-packages\sklearn\utils\validation.py:70: FutureWarning: Pass labels=['B-LOC', 'B-ORG', 'B-PESSOA', 'I-LOC', 'I-ORG', 'I-PESSOA', 'O'] as keyword args. From version 1.0 (renaming of 0.25) passing these as positional arguments will result in an error
  warnings.warn(f"Pass {args_msg} as keyword args. From version "
              precision    recall  f1-score   support

         LOC       0.85      0.94      0.89       279
         ORG       0.87      0.91      0.89       786
      PESSOA       0.86      0.97      0.91       323

   micro avg       0.86      0.93      0.90      1388
   macro avg       0.86      0.94      0.90      1388
weighted avg       0.86      0.93      0.90      1388

              precision    recall  f1-score   support

       B-LOC       0.86      0.94      0.90       277
       B-ORG       0.92      0.94      0.93       782
    B-PESSOA       0.88      0.98      0.93       322
       I-LOC       0.86      0.95      0.90       154
       I-ORG       0.92      0.92      0.92      1312
    I-PESSOA       0.92      0.98      0.95       434
           O       1.00      0.99      0.99     27012

    accuracy                           0.99     30293
   macro avg       0.91      0.96      0.93     30293
weighted avg       0.99      0.99      0.99     30293

f1 0.8954498089614449 f1_masked 0.8993006993006992
                                                   
100%|██████████| 4020/4020 [34:14<00:00,  2.48it/s]
100%|██████████| 34/34 [00:04<00:00, 10.96it/s]
                                               Saving model checkpoint to ./results\checkpoint-4020
Configuration saved in ./results\checkpoint-4020\config.json
{'eval_loss': 0.12378952652215958, 'eval_accuracy_score': 0.9852111048757138, 'eval_precision': 0.8645204560697518, 'eval_recall': 0.9286743515850144, 'eval_f1': 0.8954498089614449, 'eval_f1_masked': 0.8993006993006992, 'eval_runtime': 4.9062, 'eval_samples_per_second': 20.382, 'epoch': 30.0}
Model weights saved in ./results\checkpoint-4020\pytorch_model.bin


Training completed. Do not forget to share your model on huggingface.co/models =)


Loading best model from ./results\checkpoint-2814 (score: 0.905344044708348).
loading configuration file ./results\checkpoint-2814\config.json
Model config BertConfig {
  "_name_or_path": "neuralmind/bert-large-portuguese-cased",
  "architectures": [
    "BertNER"
  ],
  "attention_probs_dropout_prob": 0.1,
  "directionality": "bidi",
  "gradient_checkpointing": false,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 1024,
  "id2label": {
    "0": "B-LOC",
    "1": "B-ORG",
    "2": "B-PESSOA",
    "3": "I-LOC",
    "4": "I-ORG",
    "5": "I-PESSOA",
    "6": "O"
  },
  "initializer_range": 0.02,
  "intermediate_size": 4096,
  "label2id": {
    "B-LOC": 0,
    "B-ORG": 1,
    "B-PESSOA": 2,
    "I-LOC": 3,
    "I-ORG": 4,
    "I-PESSOA": 5,
    "O": 6
  },
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 16,
  "num_hidden_layers": 24,
  "output_past": true,
  "pad_token_id": 0,
  "pooler_fc_size": 768,
  "pooler_num_attention_heads": 12,
  "pooler_num_fc_layers": 3,
  "pooler_size_per_head": 128,
  "pooler_type": "first_token_transform",
  "position_embedding_type": "absolute",
  "transformers_version": "4.5.1",
  "type_vocab_size": 2,
  "use_cache": true,
  "vocab_size": 29794
}

loading weights file ./results\checkpoint-2814\pytorch_model.bin
All model checkpoint weights were used when initializing BertNER.

All the weights of BertNER were initialized from the model checkpoint at ./results\checkpoint-2814.
If your task is similar to the task the model of the checkpoint was trained on, you can already use BertNER for predictions without further training.
100%|██████████| 4020/4020 [34:24<00:00,  1.95it/s]
***** Running Evaluation *****
  Num examples = 100
  Batch size = 3
{'train_runtime': 2064.0075, 'train_samples_per_second': 1.948, 'epoch': 30.0}
TrainOutput(global_step=4020, training_loss=0.03587840654358322, metrics={'train_runtime': 2064.0075, 'train_samples_per_second': 1.948, 'epoch': 30.0})
 97%|█████████▋| 33/34 [00:02<00:00, 10.97it/s]{'TP': 3118, 'FP': 342, 'FN': 102, 'TN': 26731}
              precision    recall  f1-score   support

         LOC       0.85      0.94      0.89       279
         ORG       0.87      0.92      0.89       786
      PESSOA       0.85      0.96      0.90       323

   micro avg       0.86      0.93      0.90      1388
   macro avg       0.86      0.94      0.90      1388
weighted avg       0.86      0.93      0.90      1388

C:\Users\aceite\anaconda3\envs\ner-noticias-mapa\lib\site-packages\sklearn\utils\validation.py:70: FutureWarning: Pass labels=['B-LOC', 'B-ORG', 'B-PESSOA', 'I-LOC', 'I-ORG', 'I-PESSOA', 'O'] as keyword args. From version 1.0 (renaming of 0.25) passing these as positional arguments will result in an error
  warnings.warn(f"Pass {args_msg} as keyword args. From version "
              precision    recall  f1-score   support

       B-LOC       0.87      0.94      0.90       277
       B-ORG       0.92      0.95      0.93       782
    B-PESSOA       0.88      0.98      0.93       322
       I-LOC       0.88      0.92      0.90       154
       I-ORG       0.90      0.94      0.92      1312
    I-PESSOA       0.91      0.98      0.95       434
           O       1.00      0.99      0.99     27012

    accuracy                           0.99     30293
   macro avg       0.91      0.96      0.93     30293
weighted avg       0.99      0.99      0.99     30293

f1 0.8958116995500173 f1_masked 0.905344044708348
100%|██████████| 34/34 [00:04<00:00,  6.94it/s]
Saving model checkpoint to models/30_epochs_large_iobe_consistency_pub
Configuration saved in models/30_epochs_large_iobe_consistency_pub\config.json
{'eval_loss': 0.1181238442659378, 'eval_accuracy_score': 0.9853431485821808, 'eval_precision': 0.8620919387075283, 'eval_recall': 0.9322766570605188, 'eval_f1': 0.8958116995500173, 'eval_f1_masked': 0.905344044708348, 'eval_runtime': 4.9809, 'eval_samples_per_second': 20.077, 'epoch': 30.0}
Model weights saved in models/30_epochs_large_iobe_consistency_pub\pytorch_model.bin


Process finished with exit code 0
